import{k as he,r as g,aJ as _e,w as q,u as ge,l as ve,f as b,i as r,s as a,v as l,F as i,q as n,at as be,a5 as G,av as Le,au as ye,aK as xe,ao as Ce,aL as Ve,p as L,ax as ke,D as y,Y as E,az as Pe,aM as Se,G as m,a0 as Ee,V as De,n as $e,O as W,P as J,aN as ze,aw as Fe,aO as Ie,aP as Me,aD as Re,aQ as Ue,aR as je,ay as Ne,aS as Te,aT as K,aU as Be,U as Oe,h as f}from"./vue-0ucuI9Mt.js";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang-CjRkRCNG.js";import{u as Ae,A as He,_ as qe,M as Ge}from"./ManualPriceCard-aYH7-Fkp.js";import{G as We,A as Je,e as Ke,f as U,b as Qe,n as Ye,u as Xe}from"./GameInfo-DP80QOUl.js";import{g as Ze}from"./index-DLYVoF7q.js";import{u as we}from"./useMemory-Bnk9i9_I.js";import{u as el}from"./usePriceStatus-DfGIRWgb.js";import{v as j}from"./index-C5EX6xUk.js";import{_ as ll}from"./PriceStatusSelect.vue_vue_type_script_setup_true_lang-BmPv4h49.js";import{_ as al}from"./_plugin-vue_export-helper-DlAUqK2U.js";const tl={class:"app-container"},nl={class:"game-info"},ol={class:"title"},sl={style:{display:"flex"}},il={key:0},ul={key:1},rl={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},cl={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},dl={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ml={class:"pager-wrapper"},pl=he({__name:"index",setup(fl){const{paginationData:p,handleCurrentChange:Q,handleSizeChange:Y}=Ae({},"jungle-leaderboard-pagination"),$=g([]),X=g(null),u=we("jungle-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1,banCharm:!1,maxItemLevel:void 0,bestManufacture:!1}),z=g(!1),C=_e(()=>{z.value=!0,Ze({currentPage:p.currentPage,size:p.pageSize,...u.value,sort:N.value}).then(s=>{p.total=s.total,$.value=s.list}).catch(s=>{console.error(s),$.value=[]}).finally(()=>{z.value=!1})},300);function _(){p.currentPage===1?C():p.currentPage=1}const N=g();function Z(s){N.value=s,C()}q([()=>p.currentPage,()=>p.pageSize,()=>j().marketData,()=>Xe().config,()=>j().buyStatus,()=>j().sellStatus],C,{immediate:!0}),q(()=>U(),()=>{C()},{deep:!0});const T=g(),V=g(!1);async function w(s){T.value=K(s),V.value=!0}const k=g(!1),B=g();function ee(s){if(!U().activated){Be.confirm(t("是否确定开启自定义价格？"),t("需先开启自定义价格"),{confirmButtonText:t("确定"),cancelButtonText:t("取消"),closeOnClickModal:!0}).then(()=>{U().setActivated(!0)});return}B.value=K(s),k.value=!0}const{t}=ge(),le=Oe();function ae(s){var c;const o=((c=s==null?void 0:s.calculator)==null?void 0:c.enhanceLevel)??(s==null?void 0:s.enhanceLevel),h=Math.floor(Number(o));if(Number.isFinite(h)&&!(h<1||h>20))return h}function te(s){const o=s==null?void 0:s.hrid;if(!o)return;const h=ae(s);le.push({path:"/enhancer",query:{hrid:o,enhanceLevel:h!==void 0?String(h):void 0}})}function ne(s){var S;const o=s==null?void 0:s.hrid,h=((S=s==null?void 0:s.calculator)==null?void 0:S.enhanceLevel)??0,c=Qe(o,h).vol??-1;return c<0?"-":Ye(c)}const oe=el("jungle-price-status");function P(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const se=ve(()=>[{label:t("强化"),value:`^${P(t("强化"))}\\+`},{label:`${t("缝纫")}${t("强化")}`,value:P(t("裁缝"))},{label:`${t("制作")}${t("强化")}`,value:P(t("制造"))},{label:`${t("锻造")}${t("强化")}`,value:P(t("锻造"))}]);return(s,o)=>{const h=Re,c=Me,S=je,ie=Ue,v=Ne,O=Te,ue=Ie,d=ke,F=Pe,I=$e("Warning"),M=De,R=Ee,re=Fe,ce=xe,de=ye,A=Le,me=be,pe=Ve;return f(),b("div",tl,[r("div",nl,[a(We),r("div",null,[a(Je,{actions:["enhancing","cheesesmithing","crafting","tailoring"],equipments:["off_hand","hands","neck","earrings","ring","pouch"]})]),a(ll,{onChange:l(oe)},null,8,["onChange"]),r("div",null,i(l(t)("打野爽！")),1)]),a(me,{gutter:20,class:"row"},{default:n(()=>[a(A,{xs:24,sm:24,md:24,lg:24,xl:16},{default:n(()=>[a(de,null,{header:n(()=>[a(ue,{class:"rank-card",ref_key:"ldSearchFormRef",ref:X,inline:!0,model:l(u)},{default:n(()=>[r("div",ol,i(l(t)("利润排行")),1),a(c,{prop:"name",label:l(t)("物品")},{default:n(()=>[a(h,{style:{width:"100px"},modelValue:l(u).name,"onUpdate:modelValue":o[0]||(o[0]=e=>l(u).name=e),placeholder:l(t)("请输入"),clearable:"",onInput:_},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(c,{prop:"project",label:l(t)("动作")},{default:n(()=>[a(ie,{style:{width:"130px"},modelValue:l(u).project,"onUpdate:modelValue":o[1]||(o[1]=e=>l(u).project=e),clearable:"",onChange:_},{default:n(()=>[(f(!0),b(W,null,J(l(se),e=>(f(),L(S,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(c,{label:l(t)("目标等级从")},{default:n(()=>[a(v,{style:{width:"80px"},min:1,max:20,modelValue:l(u).minLevel,"onUpdate:modelValue":o[2]||(o[2]=e=>l(u).minLevel=e),placeholder:"1",clearable:"",onChange:_,"controls-position":"right"},null,8,["modelValue"]),m(" "+i(l(t)("到"))+"  ",1),a(v,{style:{width:"80px"},min:1,max:20,modelValue:l(u).maxLevel,"onUpdate:modelValue":o[3]||(o[3]=e=>l(u).maxLevel=e),placeholder:"20",clearable:"",onChange:_,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"]),a(c,{label:`${l(t)("售价")} ≥`},{default:n(()=>[a(v,{style:{width:"80px"},modelValue:l(u).minSellPrice,"onUpdate:modelValue":o[4]||(o[4]=e=>l(u).minSellPrice=e),placeholder:"0",clearable:"",onChange:_,controls:!1},null,8,["modelValue"]),o[12]||(o[12]=m(" M "))]),_:1},8,["label"]),a(c,{label:`${l(t)("物品等级")} ≥`},{default:n(()=>[a(v,{style:{width:"80px"},modelValue:l(u).minItemLevel,"onUpdate:modelValue":o[5]||(o[5]=e=>l(u).minItemLevel=e),placeholder:"0",clearable:"",onChange:_,controls:!1},null,8,["modelValue"])]),_:1},8,["label"]),a(c,{label:`${l(t)("物品等级")} ≤`},{default:n(()=>[a(v,{style:{width:"80px"},modelValue:l(u).maxItemLevel,"onUpdate:modelValue":o[6]||(o[6]=e=>l(u).maxItemLevel=e),placeholder:"",clearable:"",onChange:_,controls:!1},null,8,["modelValue"])]),_:1},8,["label"]),a(c,{label:`${l(t)("风险")} ≤`},{default:n(()=>[a(v,{style:{width:"80px"},modelValue:l(u).maxRisk,"onUpdate:modelValue":o[7]||(o[7]=e=>l(u).maxRisk=e),clearable:"",onChange:_,controls:!1},null,8,["modelValue"])]),_:1},8,["label"]),a(c,null,{default:n(()=>[a(O,{modelValue:l(u).bestManufacture,"onUpdate:modelValue":o[8]||(o[8]=e=>l(u).bestManufacture=e),onChange:_},{default:n(()=>[m(i(l(t)("最佳制作方案")),1)]),_:1},8,["modelValue"])]),_:1}),a(c,null,{default:n(()=>[a(O,{modelValue:l(u).banCharm,"onUpdate:modelValue":o[9]||(o[9]=e=>l(u).banCharm=e),onChange:_},{default:n(()=>[m(i(l(t)("排除护符")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),default:n(()=>[Ce((f(),L(re,{data:l($),onSortChange:Z},{default:n(()=>[a(d,{width:"54"},{default:n(({row:e})=>[a(D,{hrid:e.hrid},null,8,["hrid"])]),_:1}),a(d,{prop:"result.name",label:l(t)("物品")},null,8,["label"]),a(d,{"min-width":"70"},{default:n(({row:e})=>[r("div",sl,[e.calculatorList&&e.calculatorList[e.calculatorList.length-1].protectLevel<e.calculatorList[e.calculatorList.length-1].enhanceLevel?(f(),L(D,{key:0,hrid:e.calculatorList[e.calculatorList.length-1].protectionItem.hrid},null,8,["hrid"])):y("",!0),e.protectLevel<e.enhanceLevel?(f(),L(D,{key:1,hrid:e.protectionItem.hrid},null,8,["hrid"])):y("",!0),e.catalyst?(f(),L(D,{key:2,hrid:`/items/${e.catalyst}`},null,8,["hrid"])):y("",!0)]),e.calculatorList&&e.calculatorList[e.calculatorList.length-1].protectLevel<e.calculatorList[e.calculatorList.length-1].enhanceLevel?(f(),b("div",il,i(l(t)("从{0}保护",[e.calculatorList[e.calculatorList.length-1].protectLevel])),1)):y("",!0),e.protectLevel<e.enhanceLevel?(f(),b("div",ul,i(l(t)("从{0}保护",[e.protectLevel])),1)):y("",!0)]),_:1}),a(d,{prop:"project",label:l(t)("动作")},null,8,["label"]),a(d,{prop:"result.profitPH",label:l(t)("利润 / h"),align:"center","min-width":"120",sortable:"custom","sort-orders":["ascending",null]},{default:n(({row:e})=>[r("span",{class:E(e.hasManualPrice?"manual":"")},i(e.result.profitPHFormat)+"  ",3),a(F,{type:"primary",icon:l(Se),onClick:x=>ee(e)},{default:n(()=>[m(i(l(t)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),a(d,{label:l(t)("损耗 / h"),align:"center"},{default:n(({row:e})=>[m(i(e.result.cost4EnhancePHFormat),1)]),_:1},8,["label"]),a(d,{align:"center","min-width":"120"},{header:n(()=>[r("div",rl,[r("div",null,i(l(t)("风险系数")),1),a(R,{placement:"top",effect:"light"},{content:n(()=>[m(i(l(t)("损耗 ÷ 利润")),1)]),default:n(()=>[a(M,null,{default:n(()=>[a(I)]),_:1})]),_:1})])]),default:n(({row:e})=>[r("span",{class:E({error:e.result.risk>7,success:e.result.risk<5})},i(e.result.profitPH>0?e.result.riskFormat:""),3)]),_:1}),a(d,{align:"center",label:l(t)("利润率")},{default:n(({row:e})=>[r("span",{class:E(e.hasManualPrice?"manual":"")},i(e.result.profitRateFormat)+"  ",3)]),_:1},8,["label"]),a(d,{align:"center","min-width":"120"},{header:n(()=>[r("div",cl,[r("div",null,i(l(t)("利润 / 次")),1),a(R,{placement:"top",effect:"light"},{content:n(()=>[m(i(l(t)("单次动作产生的利润。"))+" ",1),o[13]||(o[13]=r("br",null,null,-1)),m(" "+i(l(t)("#多步动作利润提示"))+" ",1),o[14]||(o[14]=r("br",null,null,-1)),m(" "+i(l(t)("#多步动作利润举例")),1)]),default:n(()=>[a(M,null,{default:n(()=>[a(I)]),_:1})]),_:1})])]),default:n(({row:e})=>[r("span",{class:E(e.hasManualPrice?"manual":"")},i(e.result.profitPPFormat)+"  ",3)]),_:1}),a(d,{label:l(t)("售价"),align:"center"},{default:n(({row:e})=>[r("span",null,i(Ke(e.calculator.productListWithPrice[0].price)),1)]),_:1},8,["label"]),a(d,{label:l(t)("成交量(1h)"),align:"center","min-width":"120"},{default:n(({row:e})=>[m(i(ne(e)),1)]),_:1},8,["label"]),a(d,{label:l(t)("到强化工具中查看"),align:"center","min-width":"140"},{default:n(({row:e})=>[a(F,{type:"primary",onClick:x=>te(e)},{default:n(()=>[m(i(l(t)("到强化工具中查看")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"]),a(d,{"min-width":"120",label:l(t)("经验 / h"),align:"center"},{default:n(({row:e})=>{var x;return[r("div",dl,[r("div",null,i(e.result.expPHFormat),1),((x=e.expList)==null?void 0:x.length)>1?(f(),L(R,{key:0,placement:"top",effect:"light"},{content:n(()=>[(f(!0),b(W,null,J(e.expList,(H,fe)=>(f(),b("div",{key:fe,style:{display:"flex",gap:"10px"}},[r("div",null,i(l(t)(H.action)),1),r("div",null,i(H.expPHFormat),1)]))),128))]),default:n(()=>[a(M,null,{default:n(()=>[a(I)]),_:1})]),_:2},1024)):y("",!0)])]}),_:1},8,["label"]),a(d,{label:l(t)("详情"),align:"center"},{default:n(({row:e})=>[a(F,{type:"primary",icon:l(ze),onClick:x=>w(e)},{default:n(()=>[m(i(l(t)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[pe,l(z)]])]),footer:n(()=>[r("div",ml,[a(ce,{background:"",layout:l(p).layout,"page-sizes":l(p).pageSizes,total:l(p).total,"page-size":l(p).pageSize,"current-page":l(p).currentPage,onSizeChange:l(Y),onCurrentChange:l(Q)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),a(A,{xs:24,sm:24,md:24,lg:24,xl:8},{default:n(()=>[a(Ge,{"memory-key":"jungle"})]),_:1})]),_:1}),a(He,{modelValue:l(V),"onUpdate:modelValue":o[10]||(o[10]=e=>G(V)?V.value=e:null),data:l(T)},null,8,["modelValue","data"]),a(qe,{modelValue:l(k),"onUpdate:modelValue":o[11]||(o[11]=e=>G(k)?k.value=e:null),data:l(B)},null,8,["modelValue","data"])])}}}),kl=al(pl,[["__scopeId","data-v-f872ce03"]]);export{kl as default};
