import{y as ne,k as oe,r as _,aJ as se,w as G,u as ie,f as k,i,s as t,F as s,v as e,q as l,at as re,a5 as H,av as ce,au as ue,aK as de,ao as me,aL as pe,p as V,ax as fe,G as g,D as N,Y as O,az as _e,aM as ge,a0 as he,V as ve,n as be,O as ye,P as Ce,aN as xe,aw as Pe,aO as De,aP as Le,aD as ke,ay as Ve,aT as $,aU as Se,h as y}from"./vue-0ucuI9Mt.js";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang-CjRkRCNG.js";import{h as we,a as Ee,b as ze,c as Fe,u as Me,A as Re,_ as Ie,M as Te}from"./ManualPriceCard-CZUTLASV.js";import{i as Ae,j as Be,D as Ue,G as je,A as Ge,f as He,h as S,u as Ne}from"./GameInfo-CD_tVD5Z.js";import{w,l as Oe,v as $e}from"./index-DYCH4vBP.js";import{u as qe}from"./useMemory-r0PnY6ha.js";import{_ as We}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{t:Je}=Oe.global;async function Ke(v){let o=[];if(w().getDecomposeCache())o=w().getDecomposeCache();else{await new Promise(d=>setTimeout(d,300));const b=Date.now();try{o=o.concat(Ye())}catch(d){console.error(d)}w().setDecomposeCache(o),ne.success(Je("计算完成，耗时{0}秒",[(Date.now()-b)/1e3]))}return we(Ee(ze(o,v),v),v)}function Ye(){const v=Ae(),o=Object.values(v.itemDetailMap),b=[];return o.filter(d=>d.enhancementCosts).forEach(d=>{for(let f=1;f<=20;f++){if(Be(d.hrid,f,"ask")===-1)continue;let C=-1/0,c;for(let h=0;h<=2;++h){const m=new Ue({hrid:d.hrid,enhanceLevel:f,catalystRank:h});m.available&&(m.run(),m.result.profitPH>C&&(C=m.result.profitPH,c=m))}c&&Fe(b,c)}}),b}const Qe={class:"app-container"},Xe={class:"game-info"},Ze={class:"title"},ea={style:{display:"flex"}},aa={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ta={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},la={class:"pager-wrapper"},na=oe({__name:"index",setup(v){const{paginationData:o,handleCurrentChange:b,handleSizeChange:d}=Me({},"decompose-leaderboard-pagination"),f=_([]),C=_(null),c=qe("decompose-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1,bestManufacture:!1}),h=_(!1),m=se(()=>{h.value=!0,Ke({currentPage:o.currentPage,size:o.pageSize,...c.value,sort:E.value}).then(u=>{o.total=u.total,f.value=u.list}).catch(u=>{console.error(u),f.value=[]}).finally(()=>{h.value=!1})},300);function L(){o.currentPage===1?m():o.currentPage=1}const E=_();function W(u){E.value=u,m()}G([()=>o.currentPage,()=>o.pageSize,()=>$e().marketData,()=>Ne().config],m,{immediate:!0}),G(()=>S(),()=>{m()},{deep:!0});const z=_(),x=_(!1);async function J(u){z.value=$(u),x.value=!0}const P=_(!1),F=_();function K(u){if(!S().activated){Se.confirm(n("是否确定开启自定义价格？"),n("需先开启自定义价格"),{confirmButtonText:n("确定"),cancelButtonText:n("取消"),closeOnClickModal:!0}).then(()=>{S().setActivated(!0)});return}F.value=$(u),P.value=!0}const{t:n}=ie();return(u,r)=>{const Y=ke,M=Le,R=Ve,Q=De,p=fe,I=_e,T=be("Warning"),A=ve,B=he,X=Pe,Z=de,ee=ue,U=ce,ae=re,te=pe;return y(),k("div",Qe,[i("div",Xe,[t(je),i("div",null,[t(Ge,{actions:["alchemy"],equipments:["hands","neck","earrings","ring","pouch"]})]),i("div",null,s(e(n)("分解爽！")),1)]),t(ae,{gutter:20,class:"row"},{default:l(()=>[t(U,{xs:24,sm:24,md:24,lg:24,xl:16},{default:l(()=>[t(ee,null,{header:l(()=>[t(Q,{class:"rank-card",ref_key:"ldSearchFormRef",ref:C,inline:!0,model:e(c)},{default:l(()=>[i("div",Ze,s(e(n)("利润排行")),1),t(M,{prop:"name",label:e(n)("物品")},{default:l(()=>[t(Y,{style:{width:"100px"},modelValue:e(c).name,"onUpdate:modelValue":r[0]||(r[0]=a=>e(c).name=a),placeholder:e(n)("请输入"),clearable:"",onInput:L},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(M,{label:e(n)("目标等级从")},{default:l(()=>[t(R,{style:{width:"80px"},min:1,max:20,modelValue:e(c).minLevel,"onUpdate:modelValue":r[1]||(r[1]=a=>e(c).minLevel=a),placeholder:"1",clearable:"",onChange:L,"controls-position":"right"},null,8,["modelValue"]),g(" "+s(e(n)("到"))+"  ",1),t(R,{style:{width:"80px"},min:1,max:20,modelValue:e(c).maxLevel,"onUpdate:modelValue":r[2]||(r[2]=a=>e(c).maxLevel=a),placeholder:"20",clearable:"",onChange:L,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:l(()=>[me((y(),V(X,{data:e(f),onSortChange:W},{default:l(()=>[t(p,{width:"54"},{default:l(({row:a})=>[t(q,{hrid:a.hrid},null,8,["hrid"])]),_:1}),t(p,{label:e(n)("物品"),"min-width":"120"},{default:l(({row:a})=>[g(s(a.result.name)+"+"+s(a.enhanceLevel),1)]),_:1},8,["label"]),t(p,{"min-width":"70"},{default:l(({row:a})=>[i("div",ea,[a.catalyst?(y(),V(q,{key:0,hrid:`/items/${a.catalyst}`},null,8,["hrid"])):N("",!0)])]),_:1}),t(p,{prop:"project",label:e(n)("动作")},null,8,["label"]),t(p,{prop:"result.profitPHFormat",label:e(n)("利润 / h"),align:"center","min-width":"120"},{default:l(({row:a})=>[i("span",{class:O(a.hasManualPrice?"manual":"")},s(a.result.profitPHFormat)+"  ",3),t(I,{type:"primary",icon:e(ge),onClick:D=>K(a)},{default:l(()=>[g(s(e(n)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),t(p,{align:"center","min-width":"120"},{header:l(()=>[i("div",aa,[i("div",null,s(e(n)("利润 / 次")),1),t(B,{placement:"top",effect:"light"},{content:l(()=>[g(s(e(n)("单次动作产生的利润。"))+" ",1),r[5]||(r[5]=i("br",null,null,-1)),g(" "+s(e(n)("#多步动作利润提示"))+" ",1),r[6]||(r[6]=i("br",null,null,-1)),g(" "+s(e(n)("#多步动作利润举例")),1)]),default:l(()=>[t(A,null,{default:l(()=>[t(T)]),_:1})]),_:1})])]),default:l(({row:a})=>[i("span",{class:O(a.hasManualPrice?"manual":"")},s(a.result.profitPPFormat)+"  ",3)]),_:1}),t(p,{prop:"result.profitRate",label:e(n)("利润率"),align:"center",sortable:"custom","sort-orders":["descending",null]},{default:l(({row:a})=>[g(s(a.result.profitRateFormat),1)]),_:1},8,["label"]),t(p,{label:e(n)("买价"),align:"center"},{default:l(({row:a})=>[i("span",null,s(He(a.ingredientListWithPrice[0].price)),1)]),_:1},8,["label"]),t(p,{"min-width":"120",label:e(n)("经验 / h"),align:"center"},{default:l(({row:a})=>{var D;return[i("div",ta,[i("div",null,s(a.result.expPHFormat),1),((D=a.expList)==null?void 0:D.length)>1?(y(),V(B,{key:0,placement:"top",effect:"light"},{content:l(()=>[(y(!0),k(ye,null,Ce(a.expList,(j,le)=>(y(),k("div",{key:le,style:{display:"flex",gap:"10px"}},[i("div",null,s(e(n)(j.action)),1),i("div",null,s(j.expPHFormat),1)]))),128))]),default:l(()=>[t(A,null,{default:l(()=>[t(T)]),_:1})]),_:2},1024)):N("",!0)])]}),_:1},8,["label"]),t(p,{label:e(n)("详情"),align:"center"},{default:l(({row:a})=>[t(I,{type:"primary",icon:e(xe),onClick:D=>J(a)},{default:l(()=>[g(s(e(n)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[te,e(h)]])]),footer:l(()=>[i("div",la,[t(Z,{background:"",layout:e(o).layout,"page-sizes":e(o).pageSizes,total:e(o).total,"page-size":e(o).pageSize,"current-page":e(o).currentPage,onSizeChange:e(d),onCurrentChange:e(b)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),t(U,{xs:24,sm:24,md:24,lg:24,xl:8},{default:l(()=>[t(Te,{"memory-key":"decompose"})]),_:1})]),_:1}),t(Re,{modelValue:e(x),"onUpdate:modelValue":r[3]||(r[3]=a=>H(x)?x.value=a:null),data:e(z)},null,8,["modelValue","data"]),t(Ie,{modelValue:e(P),"onUpdate:modelValue":r[4]||(r[4]=a=>H(P)?P.value=a:null),data:e(F)},null,8,["modelValue","data"])])}}}),ma=We(na,[["__scopeId","data-v-6bb60520"]]);export{ma as default};
