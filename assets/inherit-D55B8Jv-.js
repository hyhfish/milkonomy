import{y as pe,k as me,r as y,aJ as fe,w as Y,u as ge,f as $,i as r,s as a,v as e,F as i,q as l,at as he,a5 as X,av as _e,au as ve,aK as be,ao as Le,aL as ye,p as B,ax as Ce,G as _,D as G,Y as N,az as xe,aM as Pe,a0 as ke,V as Ee,n as Ve,O as Se,P as De,aN as we,aw as je,aO as ze,aP as Me,aD as Fe,ay as Ie,aQ as Re,aR as Z,aS as He,h as k}from"./vue-CMGQ9A1z.js";import{i as $e,g as Te,_ as ee}from"./index.vue_vue_type_script_setup_true_lang-BTWGwO90.js";import{h as Ue,b as Ae,c as Oe,d as Be,u as Ge,a as Ne,A as We,_ as Je,M as qe}from"./ManualPriceCard-B59PizNV.js";import{h as Ke,M as Qe,i as te,E as ae,G as Ye,A as Xe,m as Ze,e as et,f as W,u as tt}from"./GameInfo-D088-w9H.js";import{W as at,g as T}from"./workflow-BdSzk2NU.js";import{w as J,l as lt,x as U,v as A}from"./index-JnRM8nM7.js";import{u as nt}from"./usePriceStatus-COtYmjCV.js";import{_ as ot}from"./PriceStatusSelect.vue_vue_type_script_setup_true_lang-DfFPDMyt.js";import{_ as it}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{t:rt}=lt.global;async function st(m){let o=[];if(J().getJungleCache("junglerit"))o=J().getJungleCache("junglerit");else{await new Promise(v=>setTimeout(v,300));const g=Date.now();try{o=o.concat(ct(m))}catch(v){console.error(v)}J().setJungleCache(o,"junglerit"),pe.success(rt("计算完成，耗时{0}秒",[(Date.now()-g)/1e3]))}return o=o.filter(g=>m.maxLevel?g.calculator.enhanceLevel<=m.maxLevel:!0),o=o.filter(g=>m.minLevel?g.calculator.enhanceLevel>=m.minLevel:!0),Ue(Ae(Oe(o,m),m),m)}function ct(m){const o=Ke(),g=Object.values(o.itemDetailMap),v=[];let E=Array.from({length:20},(u,s)=>s);return m.noEscape&&(E=[-1]),g.filter(u=>u.enhancementCosts).filter(u=>!$e(u)).filter(u=>Te(u)==="charm"||u.itemLevel>=90).forEach(u=>{for(let s=1;s<=20;s++){const w=[[U("锻造"),"cheesesmithing"],[U("制造"),"crafting"],[U("裁缝"),"tailoring"]];for(const[b,V]of w){const C=new Qe({hrid:u.hrid,project:b,action:V,originLevel:s}),S=C.actionItem;if(!(S!=null&&S.upgradeItemHrid)||te(S.upgradeItemHrid,s,"ask")===-1)continue;const L=Math.floor(C.targetLevel);for(let p=L+1;p<=20;++p){if(te(u.hrid,p,"bid")===-1)continue;let x=-1/0,j;for(const h of E)if(!(L>=p||h>=L))for(let P=Math.max(2,h+1);P<=p;P++){const z=new ae({originLevel:L,enhanceLevel:p,protectLevel:P,hrid:u.hrid,escapeLevel:h});let n;if(!z.available)continue;if(C.targetLevel%1>0){if(n=new ae({originLevel:L+1,enhanceLevel:p,protectLevel:P,hrid:u.hrid,escapeLevel:h}),L+1===p)n=void 0;else if(!n.available)continue}const D=new at([T(C),n?[T(z),T(n)]:T(z)],`${b}+${s} ${U("强化")}+${p}`);D.run(),D.result.profitPH>x&&(x=D.result.profitPH,j=D)}j&&Be(v,j)}}}}),v}const ut={class:"app-container"},dt={class:"game-info"},pt={class:"title"},mt={style:{display:"flex"}},ft={key:0},gt={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ht={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},_t={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},vt={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},bt={class:"pager-wrapper"},Lt=me({__name:"inherit",setup(m){const{paginationData:o,handleCurrentChange:g,handleSizeChange:v}=Ge({},"junglerit-leaderboard-pagination"),E=y([]),u=y(null),s=Ne("junglerit-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1}),w=y(!1),b=fe(()=>{w.value=!0,st({currentPage:o.currentPage,size:o.pageSize,...s.value,sort:C.value}).then(f=>{o.total=f.total,E.value=f.list}).catch(f=>{console.error(f),E.value=[]}).finally(()=>{w.value=!1})},300);function V(){o.currentPage===1?b():o.currentPage=1}const C=y();function S(f){C.value=f,b()}function L(){o.currentPage=1,A().clearJungleCache("junglerit"),b()}Y([()=>o.currentPage,()=>o.pageSize,()=>A().marketData,()=>tt().config,()=>A().buyStatus,()=>A().sellStatus],b,{immediate:!0}),Y(()=>W(),()=>{b()},{deep:!0});const p=y(),x=y(!1);async function j(f){p.value=Z(f),x.value=!0}const h=y(!1),P=y();function z(f){if(!W().activated){He.confirm(n("是否确定开启自定义价格？"),n("需先开启自定义价格"),{confirmButtonText:n("确定"),cancelButtonText:n("取消"),closeOnClickModal:!0}).then(()=>{W().setActivated(!0)});return}P.value=Z(f),h.value=!0}const{t:n}=ge(),D=nt("junglerit-price-status");return(f,c)=>{const le=Fe,M=Me,O=Ie,ne=Re,oe=ze,d=Ce,q=xe,F=Ve("Warning"),I=Ee,R=ke,ie=je,re=be,se=ve,K=_e,ce=he,ue=ye;return k(),$("div",ut,[r("div",dt,[a(Ye),r("div",null,[a(Xe,{actions:["enhancing"],equipments:["hands","neck","earrings","ring","pouch"]})]),a(ot,{onChange:e(D)},null,8,["onChange"]),r("div",null,i(e(n)("打野爽！")),1)]),a(ce,{gutter:20,class:"row"},{default:l(()=>[a(K,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[a(se,null,{header:l(()=>[a(oe,{class:"rank-card",ref_key:"ldSearchFormRef",ref:u,inline:!0,model:e(s)},{default:l(()=>[r("div",pt,i(e(n)("利润排行")),1),a(M,{prop:"name",label:e(n)("物品")},{default:l(()=>[a(le,{style:{width:"100px"},modelValue:e(s).name,"onUpdate:modelValue":c[0]||(c[0]=t=>e(s).name=t),placeholder:e(n)("请输入"),clearable:"",onInput:V},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(M,{label:e(n)("目标等级从")},{default:l(()=>[a(O,{style:{width:"80px"},min:1,max:20,modelValue:e(s).minLevel,"onUpdate:modelValue":c[1]||(c[1]=t=>e(s).minLevel=t),placeholder:"1",clearable:"",onChange:V,"controls-position":"right"},null,8,["modelValue"]),_(" "+i(e(n)("到"))+"  ",1),a(O,{style:{width:"80px"},min:1,max:20,modelValue:e(s).maxLevel,"onUpdate:modelValue":c[2]||(c[2]=t=>e(s).maxLevel=t),placeholder:"20",clearable:"",onChange:V,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"]),a(M,{label:`${e(n)("风险")} ≤`},{default:l(()=>[a(O,{style:{width:"80px"},modelValue:e(s).maxRisk,"onUpdate:modelValue":c[3]||(c[3]=t=>e(s).maxRisk=t),clearable:"",onChange:V,controls:!1},null,8,["modelValue"])]),_:1},8,["label"]),a(M,null,{default:l(()=>[a(ne,{modelValue:e(s).noEscape,"onUpdate:modelValue":c[4]||(c[4]=t=>e(s).noEscape=t),onChange:L},{default:l(()=>[_(i(e(n)("不逃逸")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),default:l(()=>[Le((k(),B(ie,{data:e(E),onSortChange:S},{default:l(()=>[a(d,{width:"54"},{default:l(({row:t})=>[a(ee,{hrid:t.hrid},null,8,["hrid"])]),_:1}),a(d,{prop:"result.name",label:e(n)("物品")},{default:l(({row:t})=>[_(i(t.result.name)+" "+i(t.originLevel?`+${t.originLevel}`:""),1)]),_:1},8,["label"]),a(d,{"min-width":"70"},{default:l(({row:t})=>[r("div",mt,[t.calculator.protectLevel<t.calculator.enhanceLevel?(k(),B(ee,{key:0,hrid:t.calculator.protectionItem.hrid},null,8,["hrid"])):G("",!0)]),t.calculator.protectLevel<t.calculator.enhanceLevel?(k(),$("div",ft,i(e(n)("从{0}保护",[t.calculator.protectLevel])),1)):G("",!0)]),_:1}),a(d,{prop:"project",label:e(n)("动作")},null,8,["label"]),a(d,{prop:"calculator.realEscapeLevel",label:e(n)("逃逸等级"),"min-width":"50"},null,8,["label"]),a(d,{prop:"result.profitPHFormat",label:e(n)("利润 / h"),align:"center","min-width":"120"},{default:l(({row:t})=>[r("span",{class:N(t.hasManualPrice?"manual":"")},i(t.result.profitPHFormat)+"  ",3),a(q,{type:"primary",icon:e(Pe),onClick:H=>z(t)},{default:l(()=>[_(i(e(n)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),a(d,{align:"center","min-width":"120"},{header:l(()=>[r("div",gt,[r("div",null,i(e(n)("损耗 / h")),1),a(R,{placement:"top",effect:"light"},{content:l(()=>[_(i(e(n)("材料损耗+逃逸损耗")),1)]),default:l(()=>[a(I,null,{default:l(()=>[a(F)]),_:1})]),_:1})])]),default:l(({row:t})=>[r("span",null,i(t.result.cost4EnhancePHFormat),1)]),_:1}),a(d,{align:"center","min-width":"120"},{header:l(()=>[r("div",ht,[r("div",null,i(e(n)("风险系数")),1),a(R,{placement:"top",effect:"light"},{content:l(()=>[_(i(e(n)("损耗 / 利润")),1)]),default:l(()=>[a(I,null,{default:l(()=>[a(F)]),_:1})]),_:1})])]),default:l(({row:t})=>[r("span",{class:N({error:t.result.risk>7,success:t.result.risk<5})},i(t.result.profitPH>0?t.result.riskFormat:""),3)]),_:1}),a(d,{align:"center","min-width":"120"},{header:l(()=>[r("div",_t,[r("div",null,i(e(n)("利润 / 件")),1),a(R,{placement:"top",effect:"light"},{content:l(()=>[_(i(e(n)("每件初始装备产生的利润。")),1)]),default:l(()=>[a(I,null,{default:l(()=>[a(F)]),_:1})]),_:1})])]),default:l(({row:t})=>[r("span",{class:N(t.hasManualPrice?"manual":"")},i(Ze(t.result.profitPH/t.ingredientListWithPrice[0].countPH))+"  ",3)]),_:1}),a(d,{prop:"result.profitRate",label:e(n)("利润率"),align:"center",sortable:"custom","sort-orders":["descending",null]},{default:l(({row:t})=>[_(i(t.result.profitRateFormat),1)]),_:1},8,["label"]),a(d,{label:e(n)("售价"),align:"center"},{default:l(({row:t})=>[r("span",null,i(et(t.calculator.productListWithPrice[0].price)),1)]),_:1},8,["label"]),a(d,{"min-width":"120",label:e(n)("经验 / h"),align:"center"},{default:l(({row:t})=>{var H;return[r("div",vt,[r("div",null,i(t.result.expPHFormat),1),((H=t.expList)==null?void 0:H.length)>1?(k(),B(R,{key:0,placement:"top",effect:"light"},{content:l(()=>[(k(!0),$(Se,null,De(t.expList,(Q,de)=>(k(),$("div",{key:de,style:{display:"flex",gap:"10px"}},[r("div",null,i(e(n)(Q.action)),1),r("div",null,i(Q.expPHFormat),1)]))),128))]),default:l(()=>[a(I,null,{default:l(()=>[a(F)]),_:1})]),_:2},1024)):G("",!0)])]}),_:1},8,["label"]),a(d,{label:e(n)("详情"),align:"center"},{default:l(({row:t})=>[a(q,{type:"primary",icon:e(we),onClick:H=>j(t)},{default:l(()=>[_(i(e(n)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[ue,e(w)]])]),footer:l(()=>[r("div",bt,[a(re,{background:"",layout:e(o).layout,"page-sizes":e(o).pageSizes,total:e(o).total,"page-size":e(o).pageSize,"current-page":e(o).currentPage,onSizeChange:e(v),onCurrentChange:e(g)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),a(K,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[a(qe,{"memory-key":"junglerit"})]),_:1})]),_:1}),a(We,{modelValue:e(x),"onUpdate:modelValue":c[5]||(c[5]=t=>X(x)?x.value=t:null),data:e(p)},null,8,["modelValue","data"]),a(Je,{modelValue:e(h),"onUpdate:modelValue":c[6]||(c[6]=t=>X(h)?h.value=t:null),data:e(P)},null,8,["modelValue","data"])])}}}),wt=it(Lt,[["__scopeId","data-v-ac168b56"]]);export{wt as default};
