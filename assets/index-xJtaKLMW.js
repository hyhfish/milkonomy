import{y as ne,k as oe,r as _,aJ as se,w as N,u as ie,f as k,i,s as t,F as s,v as e,q as l,at as re,a5 as O,av as ce,au as ue,aK as de,ao as pe,aL as me,p as S,ax as fe,G as g,D as U,Y as j,az as _e,aM as ge,a0 as he,V as ve,n as be,O as ye,P as Ce,aN as xe,aw as Pe,aO as De,aP as Le,aD as ke,ay as Se,aR as $,aS as Ve,h as y}from"./vue-CMGQ9A1z.js";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang-BTWGwO90.js";import{h as we,b as Ee,c as ze,d as Fe,u as Me,a as Re,A as Ie,_ as Te,M as Ae}from"./ManualPriceCard-B59PizNV.js";import{h as Be,i as Ge,D as He,G as Ne,A as Oe,e as Ue,f as V,u as je}from"./GameInfo-D088-w9H.js";import{w,l as $e,v as qe}from"./index-JnRM8nM7.js";import{_ as We}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./workflow-BdSzk2NU.js";const{t:Je}=$e.global;async function Ke(v){let o=[];if(w().getDecomposeCache())o=w().getDecomposeCache();else{await new Promise(d=>setTimeout(d,300));const b=Date.now();try{o=o.concat(Ye())}catch(d){console.error(d)}w().setDecomposeCache(o),ne.success(Je("计算完成，耗时{0}秒",[(Date.now()-b)/1e3]))}return we(Ee(ze(o,v),v),v)}function Ye(){const v=Be(),o=Object.values(v.itemDetailMap),b=[];return o.filter(d=>d.enhancementCosts).forEach(d=>{for(let f=1;f<=20;f++){if(Ge(d.hrid,f,"ask")===-1)continue;let C=-1/0,c;for(let h=0;h<=2;++h){const p=new He({hrid:d.hrid,enhanceLevel:f,catalystRank:h});p.available&&(p.run(),p.result.profitPH>C&&(C=p.result.profitPH,c=p))}c&&Fe(b,c)}}),b}const Qe={class:"app-container"},Xe={class:"game-info"},Ze={class:"title"},ea={style:{display:"flex"}},aa={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ta={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},la={class:"pager-wrapper"},na=oe({__name:"index",setup(v){const{paginationData:o,handleCurrentChange:b,handleSizeChange:d}=Me({},"decompose-leaderboard-pagination"),f=_([]),C=_(null),c=Re("decompose-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1,bestManufacture:!1}),h=_(!1),p=se(()=>{h.value=!0,Ke({currentPage:o.currentPage,size:o.pageSize,...c.value,sort:E.value}).then(u=>{o.total=u.total,f.value=u.list}).catch(u=>{console.error(u),f.value=[]}).finally(()=>{h.value=!1})},300);function L(){o.currentPage===1?p():o.currentPage=1}const E=_();function W(u){E.value=u,p()}N([()=>o.currentPage,()=>o.pageSize,()=>qe().marketData,()=>je().config],p,{immediate:!0}),N(()=>V(),()=>{p()},{deep:!0});const z=_(),x=_(!1);async function J(u){z.value=$(u),x.value=!0}const P=_(!1),F=_();function K(u){if(!V().activated){Ve.confirm(n("是否确定开启自定义价格？"),n("需先开启自定义价格"),{confirmButtonText:n("确定"),cancelButtonText:n("取消"),closeOnClickModal:!0}).then(()=>{V().setActivated(!0)});return}F.value=$(u),P.value=!0}const{t:n}=ie();return(u,r)=>{const Y=ke,M=Le,R=Se,Q=De,m=fe,I=_e,T=be("Warning"),A=ve,B=he,X=Pe,Z=de,ee=ue,G=ce,ae=re,te=me;return y(),k("div",Qe,[i("div",Xe,[t(Ne),i("div",null,[t(Oe,{actions:["alchemy"],equipments:["hands","neck","earrings","ring","pouch"]})]),i("div",null,s(e(n)("分解爽！")),1)]),t(ae,{gutter:20,class:"row"},{default:l(()=>[t(G,{xs:24,sm:24,md:24,lg:24,xl:16},{default:l(()=>[t(ee,null,{header:l(()=>[t(Q,{class:"rank-card",ref_key:"ldSearchFormRef",ref:C,inline:!0,model:e(c)},{default:l(()=>[i("div",Ze,s(e(n)("利润排行")),1),t(M,{prop:"name",label:e(n)("物品")},{default:l(()=>[t(Y,{style:{width:"100px"},modelValue:e(c).name,"onUpdate:modelValue":r[0]||(r[0]=a=>e(c).name=a),placeholder:e(n)("请输入"),clearable:"",onInput:L},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(M,{label:e(n)("目标等级从")},{default:l(()=>[t(R,{style:{width:"80px"},min:1,max:20,modelValue:e(c).minLevel,"onUpdate:modelValue":r[1]||(r[1]=a=>e(c).minLevel=a),placeholder:"1",clearable:"",onChange:L,"controls-position":"right"},null,8,["modelValue"]),g(" "+s(e(n)("到"))+"  ",1),t(R,{style:{width:"80px"},min:1,max:20,modelValue:e(c).maxLevel,"onUpdate:modelValue":r[2]||(r[2]=a=>e(c).maxLevel=a),placeholder:"20",clearable:"",onChange:L,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:l(()=>[pe((y(),S(X,{data:e(f),onSortChange:W},{default:l(()=>[t(m,{width:"54"},{default:l(({row:a})=>[t(q,{hrid:a.hrid},null,8,["hrid"])]),_:1}),t(m,{label:e(n)("物品"),"min-width":"120"},{default:l(({row:a})=>[g(s(a.result.name)+"+"+s(a.enhanceLevel),1)]),_:1},8,["label"]),t(m,{"min-width":"70"},{default:l(({row:a})=>[i("div",ea,[a.catalyst?(y(),S(q,{key:0,hrid:`/items/${a.catalyst}`},null,8,["hrid"])):U("",!0)])]),_:1}),t(m,{prop:"project",label:e(n)("动作")},null,8,["label"]),t(m,{prop:"result.profitPHFormat",label:e(n)("利润 / h"),align:"center","min-width":"120"},{default:l(({row:a})=>[i("span",{class:j(a.hasManualPrice?"manual":"")},s(a.result.profitPHFormat)+"  ",3),t(I,{type:"primary",icon:e(ge),onClick:D=>K(a)},{default:l(()=>[g(s(e(n)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),t(m,{align:"center","min-width":"120"},{header:l(()=>[i("div",aa,[i("div",null,s(e(n)("利润 / 次")),1),t(B,{placement:"top",effect:"light"},{content:l(()=>[g(s(e(n)("单次动作产生的利润。"))+" ",1),r[5]||(r[5]=i("br",null,null,-1)),g(" "+s(e(n)("#多步动作利润提示"))+" ",1),r[6]||(r[6]=i("br",null,null,-1)),g(" "+s(e(n)("#多步动作利润举例")),1)]),default:l(()=>[t(A,null,{default:l(()=>[t(T)]),_:1})]),_:1})])]),default:l(({row:a})=>[i("span",{class:j(a.hasManualPrice?"manual":"")},s(a.result.profitPPFormat)+"  ",3)]),_:1}),t(m,{prop:"result.profitRate",label:e(n)("利润率"),align:"center",sortable:"custom","sort-orders":["descending",null]},{default:l(({row:a})=>[g(s(a.result.profitRateFormat),1)]),_:1},8,["label"]),t(m,{label:e(n)("买价"),align:"center"},{default:l(({row:a})=>[i("span",null,s(Ue(a.ingredientListWithPrice[0].price)),1)]),_:1},8,["label"]),t(m,{"min-width":"120",label:e(n)("经验 / h"),align:"center"},{default:l(({row:a})=>{var D;return[i("div",ta,[i("div",null,s(a.result.expPHFormat),1),((D=a.expList)==null?void 0:D.length)>1?(y(),S(B,{key:0,placement:"top",effect:"light"},{content:l(()=>[(y(!0),k(ye,null,Ce(a.expList,(H,le)=>(y(),k("div",{key:le,style:{display:"flex",gap:"10px"}},[i("div",null,s(e(n)(H.action)),1),i("div",null,s(H.expPHFormat),1)]))),128))]),default:l(()=>[t(A,null,{default:l(()=>[t(T)]),_:1})]),_:2},1024)):U("",!0)])]}),_:1},8,["label"]),t(m,{label:e(n)("详情"),align:"center"},{default:l(({row:a})=>[t(I,{type:"primary",icon:e(xe),onClick:D=>J(a)},{default:l(()=>[g(s(e(n)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[te,e(h)]])]),footer:l(()=>[i("div",la,[t(Z,{background:"",layout:e(o).layout,"page-sizes":e(o).pageSizes,total:e(o).total,"page-size":e(o).pageSize,"current-page":e(o).currentPage,onSizeChange:e(d),onCurrentChange:e(b)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),t(G,{xs:24,sm:24,md:24,lg:24,xl:8},{default:l(()=>[t(Ae,{"memory-key":"decompose"})]),_:1})]),_:1}),t(Ie,{modelValue:e(x),"onUpdate:modelValue":r[3]||(r[3]=a=>O(x)?x.value=a:null),data:e(z)},null,8,["modelValue","data"]),t(Te,{modelValue:e(P),"onUpdate:modelValue":r[4]||(r[4]=a=>O(P)?P.value=a:null),data:e(F)},null,8,["modelValue","data"])])}}}),pa=We(na,[["__scopeId","data-v-6bb60520"]]);export{pa as default};
