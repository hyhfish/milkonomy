import{y as se,k as re,r as _,aJ as ie,w as G,u as ce,n as ue,f as S,h as g,i as s,s as t,F as r,v as e,q as l,av as de,au as pe,aK as me,ao as fe,p as V,aw as he,ax as _e,D as w,Y as H,az as ge,aM as ve,G as y,a0 as be,V as Le,O as ye,P as Ce,aN as xe,aL as Pe,aO as De,aP as ke,aD as Ee,ay as Se,at as Ve,a5 as W,aR as q,aS as we}from"./vue-DmXGC6sY.js";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-D7BdDwpT.js";import{h as ze,a as Fe,b as Ie,c as Me,u as Re,M as Te,A as Ae,_ as Be}from"./ManualPriceCard-BsFLjzyk.js";import{h as Ne,i as J,E as Oe,D as $e,G as Ue,A as je,f as I,d as Ge,u as He}from"./GameInfo-CNcGxt3R.js";import{W as We,g as K,u as qe}from"./useMemory-CDNT2ByA.js";import{w as z,l as Je,x as Ke}from"./index-B04nlXUz.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{t:Qe}=Je.global;async function Xe(m){let o=[];if(z().getEnhanposerCache())o=z().getEnhanposerCache();else{await new Promise(c=>setTimeout(c,300));const f=Date.now();try{o=o.concat(Ze())}catch(c){console.error(c)}z().setEnhanposerCache(o),se.success(Qe("计算完成，耗时{0}秒",[(Date.now()-f)/1e3]))}return o=o.filter(f=>m.maxLevel?f.calculator.enhanceLevel<=m.maxLevel:!0),o=o.filter(f=>m.minLevel?f.calculator.enhanceLevel>=m.minLevel:!0),ze(Fe(Ie(o,m),m),m)}function Ze(){const m=Ne(),o=Object.values(m.itemDetailMap),f=[];return o.filter(c=>c.enhancementCosts).forEach(c=>{if(J(c.hrid,0,"ask")!==-1)for(let d=1;d<=20;d++){if(J(c.hrid,0,"ask")===-1)continue;let P=-1/0,u;for(let v=d>2?2:d;v<=d;v++){const b=new Oe({enhanceLevel:d,protectLevel:v,hrid:c.hrid});for(let L=0;L<=2;L++){if(!z().checkSecret()&&c.itemLevel>1)continue;const x=new $e({enhanceLevel:d,hrid:c.hrid,catalystRank:L});if(!x.available||!b.profitable)continue;const C=new We([K(b),K(x)],`${Ke("强化分解")}+${d}`);C.run(),C.result.profitPH>P&&(P=C.result.profitPH,u=C)}}u&&Me(f,u)}}),f}const ea={class:"app-container"},aa={class:"game-info"},ta={class:"title"},la={style:{display:"flex"}},na={key:0},oa={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},sa={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ra={class:"pager-wrapper"},ia=re({__name:"index",setup(m){const{paginationData:o,handleCurrentChange:f,handleSizeChange:c}=Re({},"enhanposer-leaderboard-pagination"),d=_([]),P=_(null),u=qe("enhanposer-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1,enhanposer:!0}),v=_(!1),b=ie(()=>{v.value=!0,Xe({currentPage:o.currentPage,size:o.pageSize,...u.value,sort:x.value}).then(p=>{o.total=p.total,d.value=p.list}).catch(p=>{console.error(p),d.value=[]}).finally(()=>{v.value=!1})},300);function L(){o.currentPage===1?b():o.currentPage=1,JSON.stringify(u.value)}const x=_();function C(p){x.value=p,b()}G([()=>o.currentPage,()=>o.pageSize,()=>Ge(),()=>He().config],b,{immediate:!0}),G(()=>I(),()=>{b()},{deep:!0});const M=_(),D=_(!1);async function Y(p){M.value=q(p),D.value=!0}const k=_(!1),R=_();function Q(p){if(!I().activated){we.confirm(n("是否确定开启自定义价格？"),n("需先开启自定义价格"),{confirmButtonText:n("确定"),cancelButtonText:n("取消"),closeOnClickModal:!0}).then(()=>{I().setActivated(!0)});return}R.value=q(p),k.value=!0}const{t:n}=ce();return(p,i)=>{const X=Ee,T=ke,A=Se,Z=De,h=_e,B=ge,N=ue("Warning"),O=Le,$=be,ee=he,ae=me,te=pe,U=de,le=Ve,ne=Pe;return g(),S("div",ea,[s("div",aa,[t(Ue),s("div",null,[t(je,{actions:["enhancing"],equipments:["hands","neck","earrings","ring","pouch"]})]),s("div",null,r(e(n)("#强化纪念")),1)]),t(le,{gutter:20,class:"row"},{default:l(()=>[t(U,{xs:24,sm:24,md:24,lg:24,xl:14},{default:l(()=>[t(te,null,{header:l(()=>[t(Z,{class:"rank-card",ref_key:"ldSearchFormRef",ref:P,inline:!0,model:e(u)},{default:l(()=>[s("div",ta,r(e(n)("利润排行")),1),t(T,{prop:"name",label:e(n)("物品")},{default:l(()=>[t(X,{style:{width:"100px"},modelValue:e(u).name,"onUpdate:modelValue":i[0]||(i[0]=a=>e(u).name=a),placeholder:e(n)("请输入"),clearable:"",onInput:L},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(T,{label:e(n)("目标等级从")},{default:l(()=>[t(A,{style:{width:"80px"},min:1,max:20,modelValue:e(u).minLevel,"onUpdate:modelValue":i[1]||(i[1]=a=>e(u).minLevel=a),placeholder:"1",clearable:"",onChange:L,"controls-position":"right"},null,8,["modelValue"]),y(" "+r(e(n)("到"))+"  ",1),t(A,{style:{width:"80px"},min:1,max:20,modelValue:e(u).maxLevel,"onUpdate:modelValue":i[2]||(i[2]=a=>e(u).maxLevel=a),placeholder:"20",clearable:"",onChange:L,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:l(()=>[fe((g(),V(ee,{data:e(d),onSortChange:C},{default:l(()=>[t(h,{width:"54",fixed:"left"},{default:l(({row:a})=>[t(F,{hrid:a.hrid},null,8,["hrid"])]),_:1}),t(h,{prop:"result.name",label:e(n)("物品")},null,8,["label"]),t(h,{"min-width":"70"},{default:l(({row:a})=>[s("div",la,[a.calculatorList&&a.calculatorList[0].protectLevel<a.calculatorList[0].enhanceLevel?(g(),V(F,{key:0,hrid:a.calculatorList[0].protectionItem.hrid},null,8,["hrid"])):w("",!0),a.catalyst?(g(),V(F,{key:1,hrid:`/items/${a.catalyst}`},null,8,["hrid"])):w("",!0)]),a.calculatorList&&a.calculatorList[0].protectLevel<a.calculatorList[0].enhanceLevel?(g(),S("div",na,r(e(n)("从{0}保护",[a.calculatorList[0].protectLevel])),1)):w("",!0)]),_:1}),t(h,{prop:"project",label:e(n)("动作")},null,8,["label"]),t(h,{label:e(n)("利润 / 天"),align:"center","min-width":"120"},{default:l(({row:a})=>[s("span",{class:H(a.hasManualPrice?"manual":"")},r(a.result.profitPDFormat)+"  ",3),t(B,{type:"primary",icon:e(ve),onClick:E=>Q(a)},{default:l(()=>[y(r(e(n)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),t(h,{prop:"result.profitPHFormat",label:e(n)("利润 / h"),align:"center","min-width":"120"},null,8,["label"]),t(h,{prop:"result.profitRate",label:e(n)("利润率"),"min-width":"100",align:"center",sortable:"custom","sort-orders":["descending",null]},{default:l(({row:a})=>[y(r(a.result.profitRateFormat),1)]),_:1},8,["label"]),t(h,{align:"center","min-width":"100"},{header:l(()=>[s("div",oa,[s("div",null,r(e(n)("利润 / 次")),1),t($,{placement:"top",effect:"light"},{content:l(()=>[y(r(e(n)("单次动作产生的利润。"))+" ",1),i[5]||(i[5]=s("br",null,null,-1)),y(" "+r(e(n)("#多步动作利润提示"))+" ",1),i[6]||(i[6]=s("br",null,null,-1)),y(" "+r(e(n)("#多步动作利润举例")),1)]),default:l(()=>[t(O,null,{default:l(()=>[t(N)]),_:1})]),_:1})])]),default:l(({row:a})=>[s("span",{class:H(a.hasManualPrice?"manual":"")},r(a.result.profitPPFormat)+"  ",3)]),_:1}),t(h,{"min-width":"120",label:e(n)("经验 / h"),align:"center"},{default:l(({row:a})=>{var E;return[s("div",sa,[s("div",null,r(a.result.expPHFormat),1),((E=a.expList)==null?void 0:E.length)>1?(g(),V($,{key:0,placement:"top",effect:"light"},{content:l(()=>[(g(!0),S(ye,null,Ce(a.expList,(j,oe)=>(g(),S("div",{key:oe,style:{display:"flex",gap:"10px"}},[s("div",null,r(e(n)(j.action)),1),s("div",null,r(j.expPHFormat),1)]))),128))]),default:l(()=>[t(O,null,{default:l(()=>[t(N)]),_:1})]),_:2},1024)):w("",!0)])]}),_:1},8,["label"]),t(h,{label:e(n)("详情"),align:"center"},{default:l(({row:a})=>[t(B,{type:"primary",icon:e(xe),onClick:E=>Y(a)},{default:l(()=>[y(r(e(n)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[ne,e(v)]])]),footer:l(()=>[s("div",ra,[t(ae,{background:"",layout:e(o).layout,"page-sizes":e(o).pageSizes,total:e(o).total,"page-size":e(o).pageSize,"current-page":e(o).currentPage,onSizeChange:e(c),onCurrentChange:e(f)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),t(U,{xs:24,sm:24,md:24,lg:24,xl:10},{default:l(()=>[t(Te,{"memory-key":"enhanposer"})]),_:1})]),_:1}),t(Ae,{modelValue:e(D),"onUpdate:modelValue":i[3]||(i[3]=a=>W(D)?D.value=a:null),data:e(M)},null,8,["modelValue","data"]),t(Be,{modelValue:e(k),"onUpdate:modelValue":i[4]||(i[4]=a=>W(k)?k.value=a:null),data:e(R)},null,8,["modelValue","data"])])}}}),_a=Ye(ia,[["__scopeId","data-v-8d224448"]]);export{_a as default};
