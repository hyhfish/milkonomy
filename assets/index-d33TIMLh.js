import{y as oe,k as se,r as b,aJ as ie,w as A,u as re,f as B,i,s as t,v as e,F as s,q as l,at as ce,a5 as U,av as ue,au as de,aK as pe,ao as me,aL as fe,p as G,ax as _e,G as _,D as N,Y as F,az as he,aM as ge,a0 as ve,V as be,n as ye,aN as Ce,aw as Le,aO as xe,aP as Pe,aD as De,ay as Se,aR as O,aS as ke,h as E}from"./vue-DmXGC6sY.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-D7BdDwpT.js";import{h as Ve,a as Ee,b as we,c as ze,u as Re,A as Fe,_ as je,M as Me}from"./ManualPriceCard-BsFLjzyk.js";import{h as Ie,i as W,E as He,G as Te,A as $e,m as Ae,e as Be,f as j,u as Ue}from"./GameInfo-CNcGxt3R.js";import{w as M,l as Ge,v as I}from"./index-B04nlXUz.js";import{u as Ne}from"./useMemory-CDNT2ByA.js";import{u as Oe}from"./usePriceStatus-Di4P0lgz.js";import{_ as Je}from"./PriceStatusSelect.vue_vue_type_script_setup_true_lang-BFE_7B7X.js";import{_ as We}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{t:qe}=Ge.global;async function Ke(p){let o=[];if(M().getJunglestCache())o=M().getJunglestCache();else{await new Promise(y=>setTimeout(y,300));const m=Date.now();try{o=o.concat(Ye())}catch(y){console.error(y)}M().setJunglestCache(o),oe.success(qe("计算完成，耗时{0}秒",[(Date.now()-m)/1e3]))}return o=o.filter(m=>p.maxLevel?m.enhanceLevel<=p.maxLevel:!0),o=o.filter(m=>p.minLevel?m.enhanceLevel>=p.minLevel:!0),Ve(Ee(we(o,p),p),p)}function Ye(){const p=Ie(),o=Object.values(p.itemDetailMap),m=[],y=[0,3,4,5,6,7,8,9,10,11,12,13,14],x=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],w=[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18];return o.filter(r=>r.enhancementCosts).forEach(r=>{for(const h of w){if(W(r.hrid,h,"bid")===-1)continue;let C=-1/0,g;for(const v of x)if(W(r.hrid,v,"ask")!==-1){for(const P of y)if(!(v>=h||P>=v))for(let L=Math.max(2,P+1);L<=h;L++){const f=new He({originLevel:v,enhanceLevel:h,protectLevel:L,hrid:r.hrid,escapeLevel:P,project:`+${v} → +${h}`});f.available&&(f.run(),f.result.profitPH>C&&(C=f.result.profitPH,g=f))}}g&&ze(m,g)}}),m}const Qe={class:"app-container"},Xe={class:"game-info"},Ze={class:"title"},et={style:{display:"flex"}},tt={key:0},at={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},lt={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},nt={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ot={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},st={class:"pager-wrapper"},it=se({__name:"index",setup(p){const{paginationData:o,handleCurrentChange:m,handleSizeChange:y}=Re({},"junglest-leaderboard-pagination"),x=b([]),w=b(null),r=Ne("junglest-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1,bestManufacture:!1}),h=b(!1),C=ie(()=>{h.value=!0,Ke({currentPage:o.currentPage,size:o.pageSize,...r.value,sort:v.value}).then(d=>{o.total=d.total,x.value=d.list}).catch(d=>{console.error(d),x.value=[]}).finally(()=>{h.value=!1})},300);function g(){o.currentPage===1?C():o.currentPage=1}const v=b();function P(d){v.value=d,C()}A([()=>o.currentPage,()=>o.pageSize,()=>I().marketData,()=>Ue().config,()=>I().buyStatus,()=>I().sellStatus],C,{immediate:!0}),A(()=>j(),()=>{C()},{deep:!0});const L=b(),f=b(!1);async function q(d){L.value=O(d),f.value=!0}const D=b(!1),H=b();function K(d){if(!j().activated){ke.confirm(n("是否确定开启自定义价格？"),n("需先开启自定义价格"),{confirmButtonText:n("确定"),cancelButtonText:n("取消"),closeOnClickModal:!0}).then(()=>{j().setActivated(!0)});return}H.value=O(d),D.value=!0}const{t:n}=re(),Y=Oe("junglest-price-status");return(d,u)=>{const Q=De,z=Pe,R=Se,X=xe,c=_e,T=he,S=ye("Warning"),k=be,V=ve,Z=Le,ee=pe,te=de,$=ue,ae=ce,le=fe;return E(),B("div",Qe,[i("div",Xe,[t(Te),i("div",null,[t($e,{actions:["enhancing"],equipments:["hands","neck","earrings","ring","pouch"]})]),t(Je,{onChange:e(Y)},null,8,["onChange"]),i("div",null,s(e(n)("打野爽！")),1)]),t(ae,{gutter:20,class:"row"},{default:l(()=>[t($,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t(te,null,{header:l(()=>[t(X,{class:"rank-card",ref_key:"ldSearchFormRef",ref:w,inline:!0,model:e(r)},{default:l(()=>[i("div",Ze,s(e(n)("利润排行")),1),t(z,{prop:"name",label:e(n)("物品")},{default:l(()=>[t(Q,{style:{width:"100px"},modelValue:e(r).name,"onUpdate:modelValue":u[0]||(u[0]=a=>e(r).name=a),placeholder:e(n)("请输入"),clearable:"",onInput:g},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(z,{label:e(n)("目标等级从")},{default:l(()=>[t(R,{style:{width:"80px"},min:1,max:20,modelValue:e(r).minLevel,"onUpdate:modelValue":u[1]||(u[1]=a=>e(r).minLevel=a),placeholder:"1",clearable:"",onChange:g,"controls-position":"right"},null,8,["modelValue"]),_(" "+s(e(n)("到"))+"  ",1),t(R,{style:{width:"80px"},min:1,max:20,modelValue:e(r).maxLevel,"onUpdate:modelValue":u[2]||(u[2]=a=>e(r).maxLevel=a),placeholder:"20",clearable:"",onChange:g,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"]),t(z,{label:`${e(n)("风险")} ≤`},{default:l(()=>[t(R,{style:{width:"80px"},modelValue:e(r).maxRisk,"onUpdate:modelValue":u[3]||(u[3]=a=>e(r).maxRisk=a),clearable:"",onChange:g,controls:!1},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:l(()=>[me((E(),G(Z,{data:e(x),onSortChange:P},{default:l(()=>[t(c,{width:"54"},{default:l(({row:a})=>[t(J,{hrid:a.hrid},null,8,["hrid"])]),_:1}),t(c,{prop:"result.name",label:e(n)("物品")},{default:l(({row:a})=>[_(s(a.result.name),1)]),_:1},8,["label"]),t(c,{"min-width":"70"},{default:l(({row:a})=>[i("div",et,[a.protectLevel<a.enhanceLevel?(E(),G(J,{key:0,hrid:a.protectionItem.hrid},null,8,["hrid"])):N("",!0)]),a.protectLevel<a.enhanceLevel?(E(),B("div",tt,s(e(n)("从{0}保护",[a.protectLevel])),1)):N("",!0)]),_:1}),t(c,{prop:"project",label:e(n)("动作"),"min-width":"100"},null,8,["label"]),t(c,{prop:"realEscapeLevel",label:e(n)("逃逸"),"min-width":"60"},null,8,["label"]),t(c,{prop:"result.profitPHFormat",label:e(n)("利润 / h"),align:"center","min-width":"120"},{default:l(({row:a})=>[i("span",{class:F(a.hasManualPrice?"manual":"")},s(a.result.profitPHFormat)+"  ",3),t(T,{type:"primary",icon:e(ge),onClick:ne=>K(a)},{default:l(()=>[_(s(e(n)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),t(c,{align:"center","min-width":"120"},{header:l(()=>[i("div",at,[i("div",null,s(e(n)("损耗 / h")),1),t(V,{placement:"top",effect:"light"},{content:l(()=>[_(s(e(n)("材料损耗+逃逸损耗")),1)]),default:l(()=>[t(k,null,{default:l(()=>[t(S)]),_:1})]),_:1})])]),default:l(({row:a})=>[i("span",null,s(a.result.cost4EnhancePHFormat),1)]),_:1}),t(c,{align:"center","min-width":"120"},{header:l(()=>[i("div",lt,[i("div",null,s(e(n)("风险系数")),1),t(V,{placement:"top",effect:"light"},{content:l(()=>[_(s(e(n)("损耗 ÷ 利润")),1)]),default:l(()=>[t(k,null,{default:l(()=>[t(S)]),_:1})]),_:1})])]),default:l(({row:a})=>[i("span",{class:F({error:a.result.risk>7,success:a.result.risk<5})},s(a.result.profitPH>0?a.result.riskFormat:""),3)]),_:1}),t(c,{align:"center","min-width":"120"},{header:l(()=>[i("div",nt,[i("div",null,s(e(n)("利润 / 件")),1),t(V,{placement:"top",effect:"light"},{content:l(()=>[_(s(e(n)("每件初始装备产生的利润。")),1)]),default:l(()=>[t(k,null,{default:l(()=>[t(S)]),_:1})]),_:1})])]),default:l(({row:a})=>[i("span",{class:F(a.hasManualPrice?"manual":"")},s(Ae(a.result.profitPH/a.ingredientListWithPrice[0].countPH))+"  ",3)]),_:1}),t(c,{prop:"result.profitRate",label:e(n)("利润率"),align:"center",sortable:"custom","sort-orders":["descending",null]},{default:l(({row:a})=>[_(s(a.result.profitRateFormat),1)]),_:1},8,["label"]),t(c,{label:e(n)("售价"),align:"center"},{default:l(({row:a})=>[i("span",null,s(Be(a.productListWithPrice[0].price)),1)]),_:1},8,["label"]),t(c,{prop:"result.targetRateFormat",label:e(n)("成功率"),align:"center"},{header:l(()=>[i("div",ot,[i("div",null,s(e(n)("成功率")),1),t(V,{placement:"top",effect:"light"},{content:l(()=>[_(s(e(n)("单件装备成功率")),1)]),default:l(()=>[t(k,null,{default:l(()=>[t(S)]),_:1})]),_:1})])]),default:l(({row:a})=>[_(s(a.result.targetRateFormat),1)]),_:1},8,["label"]),t(c,{prop:"result.expPHFormat",label:e(n)("经验 / h")},null,8,["label"]),t(c,{label:e(n)("详情"),align:"center"},{default:l(({row:a})=>[t(T,{type:"primary",icon:e(Ce),onClick:ne=>q(a)},{default:l(()=>[_(s(e(n)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[le,e(h)]])]),footer:l(()=>[i("div",st,[t(ee,{background:"",layout:e(o).layout,"page-sizes":e(o).pageSizes,total:e(o).total,"page-size":e(o).pageSize,"current-page":e(o).currentPage,onSizeChange:e(y),onCurrentChange:e(m)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),t($,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t(Me,{"memory-key":"junglest"})]),_:1})]),_:1}),t(Fe,{modelValue:e(f),"onUpdate:modelValue":u[4]||(u[4]=a=>U(f)?f.value=a:null),data:e(L)},null,8,["modelValue","data"]),t(je,{modelValue:e(D),"onUpdate:modelValue":u[5]||(u[5]=a=>U(D)?D.value=a:null),data:e(H)},null,8,["modelValue","data"])])}}}),gt=We(it,[["__scopeId","data-v-db315457"]]);export{gt as default};
