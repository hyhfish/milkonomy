import{y as me,k as fe,r as x,aJ as he,w as K,u as ge,f as F,i as c,s as a,v as e,q as n,at as _e,a5 as W,av as be,au as ve,aK as Ce,ao as ye,aL as Pe,p as I,ax as we,D as J,F as d,Y as R,az as xe,aM as De,G as D,a0 as Se,V as Ve,aV as Q,O as ke,P as je,aN as Ee,aw as Le,aO as Me,aP as ze,aD as Fe,aQ as Ie,aR as Re,aS as Te,aT as Y,aU as Ae,h as k}from"./vue-0ucuI9Mt.js";import{h as $e,M as X,T as Ne,D as Be,C as Oe,G as Ue,A as Ge,j as He,f as T,u as qe}from"./GameInfo-DP80QOUl.js";import{g as N,W as Ke,u as We}from"./useMemory-Bnk9i9_I.js";import{w as A,l as Je,x as E,v as $}from"./index-C5EX6xUk.js";import{h as Qe,a as Ye,b as Xe,c as Ze,u as ea,A as aa,_ as la,M as ta}from"./ManualPriceCard-aYH7-Fkp.js";import{_ as Z}from"./index.vue_vue_type_script_setup_true_lang-CjRkRCNG.js";import{u as na}from"./usePriceStatus-DfGIRWgb.js";import{_ as oa}from"./PriceStatusSelect.vue_vue_type_script_setup_true_lang-BmPv4h49.js";import{_ as ra}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{t:ae}=Je.global;async function sa(_){let o=[];if(A().getManualchemyCache())o=A().getManualchemyCache();else{await new Promise(b=>setTimeout(b,300));const C=Date.now();try{o=o.concat(ia())}catch(b){console.error(b)}A().setManualchemyCache(o),me.success(ae("计算完成，耗时{0}秒",[(Date.now()-C)/1e3]))}return Qe(Ye(Xe(o,_),_),_)}function ia(){const _=$e(),o=Object.values(_.itemDetailMap),C=[],b=[[E("锻造"),"cheesesmithing"],[E("制造"),"crafting"],[E("裁缝"),"tailoring"],[E("烹饪"),"cooking"],[E("冲泡"),"brewing"]],p=new Map;function u(r,m=[]){const v=[r,...m].join(",");if(p.has(v))return p.get(v);const i=ae(r,m);return p.set(v,i),i}return o.forEach(r=>{for(const[m,v]of b){const i=[];let y=new X({hrid:r.hrid,project:m,action:v}),S=y.actionItem;for(;S!=null&&S.upgradeItemHrid;){if(i.unshift(N(y)),i.length>=1){let w=u("{0}步{1}",[i.length,m]);const P=i.find(L=>L.project!==m);P&&(w+=u("({0})",[P.project])),ee({item:r,projectName:w,configs:i,profitList:C})}for(const[w,P]of b)if(y=new X({hrid:S.upgradeItemHrid,project:w,action:P}),y.actionItem)break;S=y.actionItem}i.unshift(N(y));let j=u("{0}步{1}",[i.length,m]);const V=i.find(w=>w.project!==m);V&&(j+=u("({0})",[V.project])),ee({item:r,projectName:j,configs:i,profitList:C})}}),C}function ee({item:_,projectName:o,configs:C,profitList:b}){const p=[];for(let u=0;u<=2;u++)p.push(new Ne({hrid:_.hrid,catalystRank:u})),p.push(new Be({hrid:_.hrid,catalystRank:u})),p.push(new Oe({hrid:_.hrid,catalystRank:u}));for(const u of p){const r=N(u);Ze(b,new Ke([...C,r],`${o}-${u.project}`))}}const ua={class:"app-container"},ca={class:"game-info"},da={class:"title"},pa={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ma={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},fa={class:"pager-wrapper"},ha=fe({__name:"index",setup(_){const{paginationData:o,handleCurrentChange:C,handleSizeChange:b}=ea({},"dashboard-leaderboard-pagination"),p=x([]),u=x(null),r=We("dashboard-manualchemy-search-data",{name:"",project:"",profitRate:10,banEquipment:!0}),m=x(!1),v=he(()=>{m.value=!0,sa({currentPage:o.currentPage,size:o.pageSize,...r.value,sort:y.value}).then(f=>{o.total=f.total,p.value=f.list}).catch(f=>{console.error(f),p.value=[]}).finally(()=>{m.value=!1})},300);function i(){o.currentPage===1?v():o.currentPage=1}const y=x();function S(f){y.value=f,v()}K([()=>o.currentPage,()=>o.pageSize,()=>$().marketData,()=>qe().config,()=>$().buyStatus,()=>$().sellStatus],v,{immediate:!0}),K(()=>T(),()=>{v()},{deep:!0});const j=x(),V=x(!1);async function w(f){j.value=Y(f),V.value=!0}const P=x(!1),L=x();function le(f){if(!T().activated){Ae.confirm(l("是否确定开启自定义价格？"),l("需先开启自定义价格"),{confirmButtonText:l("确定"),cancelButtonText:l("取消"),closeOnClickModal:!0}).then(()=>{T().setActivated(!0)});return}L.value=Y(f),P.value=!0}const{t:l}=ge(),te=na("manualchemy-price-status");return(f,s)=>{const B=Fe,M=ze,h=Re,ne=Ie,oe=Te,re=Me,g=we,O=xe,U=Ve,G=Se,se=Le,ie=Ce,ue=ve,H=be,ce=_e,de=Pe;return k(),F("div",ua,[c("div",ca,[a(Ue),c("div",null,[a(Ge)]),a(oa,{onChange:e(te)},null,8,["onChange"])]),a(ce,{gutter:20,class:"row"},{default:n(()=>[a(H,{xs:24,sm:24,md:24,lg:24,xl:14},{default:n(()=>[a(ue,null,{header:n(()=>[a(re,{class:"rank-card",ref_key:"ldSearchFormRef",ref:u,inline:!0,model:e(r)},{default:n(()=>[c("div",da,d(e(l)("利润排行")),1),a(M,{prop:"name",label:e(l)("物品")},{default:n(()=>[a(B,{style:{width:"100px"},modelValue:e(r).name,"onUpdate:modelValue":s[0]||(s[0]=t=>e(r).name=t),placeholder:e(l)("请输入"),clearable:"",onInput:i},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(M,{prop:"phone",label:e(l)("动作")},{default:n(()=>[a(ne,{modelValue:e(r).project,"onUpdate:modelValue":s[1]||(s[1]=t=>e(r).project=t),placeholder:e(l)("请选择"),style:{width:"100px"},clearable:"",onChange:i},{default:n(()=>[a(h,{label:e(l)("挤奶"),value:e(l)("挤奶")},null,8,["label","value"]),a(h,{label:e(l)("采摘"),value:e(l)("采摘")},null,8,["label","value"]),a(h,{label:e(l)("伐木"),value:e(l)("伐木")},null,8,["label","value"]),a(h,{label:e(l)("锻造"),value:e(l)("锻造")},null,8,["label","value"]),a(h,{label:e(l)("制造"),value:e(l)("制造")},null,8,["label","value"]),a(h,{label:e(l)("裁缝"),value:e(l)("裁缝")},null,8,["label","value"]),a(h,{label:e(l)("烹饪"),value:e(l)("烹饪")},null,8,["label","value"]),a(h,{label:e(l)("冲泡"),value:e(l)("冲泡")},null,8,["label","value"]),a(h,{label:e(l)("点金"),value:e(l)("点金")},null,8,["label","value"]),a(h,{label:e(l)("分解"),value:e(l)("分解")},null,8,["label","value"]),a(h,{label:e(l)("转化"),value:e(l)("转化")},null,8,["label","value"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(M,{prop:"name",label:`${e(l)("利润率")} >`},{default:n(()=>[a(B,{style:{width:"60px"},modelValue:e(r).profitRate,"onUpdate:modelValue":s[2]||(s[2]=t=>e(r).profitRate=t),placeholder:e(l)("请输入"),clearable:"",onInput:i},null,8,["modelValue","placeholder"]),s[6]||(s[6]=D(" % "))]),_:1},8,["label"]),a(M,null,{default:n(()=>[a(oe,{modelValue:e(r).banEquipment,"onUpdate:modelValue":s[3]||(s[3]=t=>e(r).banEquipment=t),onChange:i},{default:n(()=>[D(d(e(l)("排除装备")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),default:n(()=>[ye((k(),I(se,{data:e(p),onSortChange:S},{default:n(()=>[a(g,{width:"54"},{default:n(({row:t})=>[a(Z,{hrid:t.hrid},null,8,["hrid"])]),_:1}),a(g,{prop:"result.name",label:e(l)("物品")},null,8,["label"]),a(g,{width:"54"},{default:n(({row:t})=>[t.catalyst?(k(),I(Z,{key:0,hrid:`/items/${t.catalyst}`},null,8,["hrid"])):J("",!0)]),_:1}),a(g,{prop:"project",label:e(l)("动作")},null,8,["label"]),a(g,{prop:"actionLevel",label:e(l)("要求等级"),align:"center"},{default:n(({row:t})=>[c("div",{class:R(t.actionLevel>e(He)(t.action).playerLevel?"red":"")},d(t.actionLevel),3)]),_:1},8,["label"]),a(g,{label:e(l)("利润 / 天"),align:"center","min-width":"120"},{default:n(({row:t})=>[c("span",{class:R(t.hasManualPrice?"manual":"")},d(t.result.profitPDFormat)+"  ",3),a(O,{type:"primary",icon:e(De),onClick:z=>le(t)},{default:n(()=>[D(d(e(l)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),a(g,{prop:"result.profitPHFormat",label:e(l)("利润 / h"),align:"center","min-width":"120"},null,8,["label"]),a(g,{prop:"result.profitRate",label:e(l)("利润率"),"min-width":"120",align:"center",sortable:"custom","sort-orders":["descending",null]},{default:n(({row:t})=>[D(d(t.result.profitRateFormat),1)]),_:1},8,["label"]),a(g,{align:"center","min-width":"120"},{header:n(()=>[c("div",pa,[c("div",null,d(e(l)("利润 / 次")),1),a(G,{placement:"top",effect:"light"},{content:n(()=>[D(d(e(l)("单次动作产生的利润。"))+" ",1),s[7]||(s[7]=c("br",null,null,-1)),D(" "+d(e(l)("#多步动作利润提示"))+" ",1),s[8]||(s[8]=c("br",null,null,-1)),D(" "+d(e(l)("#多步动作利润举例")),1)]),default:n(()=>[a(U,null,{default:n(()=>[a(e(Q))]),_:1})]),_:1})])]),default:n(({row:t})=>[c("span",{class:R(t.hasManualPrice?"manual":"")},d(t.result.profitPPFormat)+"  ",3)]),_:1}),a(g,{"min-width":"120",label:e(l)("经验 / h"),align:"center"},{default:n(({row:t})=>{var z;return[c("div",ma,[c("div",null,d(t.result.expPHFormat),1),((z=t.expList)==null?void 0:z.length)>1?(k(),I(G,{key:0,placement:"top",effect:"light"},{content:n(()=>[(k(!0),F(ke,null,je(t.expList,(q,pe)=>(k(),F("div",{key:pe,style:{display:"flex",gap:"10px"}},[c("div",null,d(e(l)(q.action)),1),c("div",null,d(q.expPHFormat),1)]))),128))]),default:n(()=>[a(U,null,{default:n(()=>[a(e(Q))]),_:1})]),_:2},1024)):J("",!0)])]}),_:1},8,["label"]),a(g,{label:e(l)("详情"),align:"center"},{default:n(({row:t})=>[a(O,{type:"primary",icon:e(Ee),onClick:z=>w(t)},{default:n(()=>[D(d(e(l)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[de,e(m)]])]),footer:n(()=>[c("div",fa,[a(ie,{background:"",layout:e(o).layout,"page-sizes":e(o).pageSizes,total:e(o).total,"page-size":e(o).pageSize,"current-page":e(o).currentPage,onSizeChange:e(b),onCurrentChange:e(C)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),a(H,{xs:24,sm:24,md:24,lg:24,xl:10},{default:n(()=>[a(ta,{"memory-key":"manualchemy"})]),_:1})]),_:1}),a(aa,{modelValue:e(V),"onUpdate:modelValue":s[4]||(s[4]=t=>W(V)?V.value=t:null),data:e(j)},null,8,["modelValue","data"]),a(la,{modelValue:e(P),"onUpdate:modelValue":s[5]||(s[5]=t=>W(P)?P.value=t:null),data:e(L)},null,8,["modelValue","data"])])}}}),Da=ra(ha,[["__scopeId","data-v-6c88b4e6"]]);export{Da as default};
