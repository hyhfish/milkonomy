import{k as ue,r as v,aJ as ce,w as H,u as de,f as y,i as r,s as a,v as l,F as i,q as t,at as me,a5 as O,av as pe,au as fe,aK as he,ao as ge,aL as _e,p as x,ax as ve,D as b,Y as P,az as be,aM as Le,G as m,a0 as ye,V as xe,n as Ce,O as Ve,P as ke,aN as Pe,aw as Se,aO as De,aP as Ee,aD as ze,ay as Ie,aQ as Fe,aR as q,aS as Me,U as Re,h}from"./vue-DmXGC6sY.js";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang-D7BdDwpT.js";import{u as Ue,a as $e,A as je,_ as Ne,M as Be}from"./ManualPriceCard-BWIbYW_2.js";import{G as Te,A as Ae,e as He,f as R,b as Oe,n as qe,u as Ge}from"./GameInfo-IQrmJeRM.js";import{g as We}from"./index-CKmR8gPy.js";import{u as Je}from"./usePriceStatus-hVI73sqA.js";import{v as U}from"./index-27uvcALl.js";import{_ as Ke}from"./PriceStatusSelect.vue_vue_type_script_setup_true_lang-BLaFOXlu.js";import{_ as Qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./workflow-BJFKHpbK.js";const Ye={class:"app-container"},Xe={class:"game-info"},Ze={class:"title"},we={style:{display:"flex"}},el={key:0},ll={key:1},al={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},tl={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},nl={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ol={class:"pager-wrapper"},sl=ue({__name:"index",setup(il){const{paginationData:p,handleCurrentChange:G,handleSizeChange:W}=Ue({},"jungle-leaderboard-pagination"),D=v([]),J=v(null),u=$e("jungle-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1,banCharm:!1,maxItemLevel:void 0,bestManufacture:!1}),E=v(!1),C=ce(()=>{E.value=!0,We({currentPage:p.currentPage,size:p.pageSize,...u.value,sort:$.value}).then(s=>{p.total=s.total,D.value=s.list}).catch(s=>{console.error(s),D.value=[]}).finally(()=>{E.value=!1})},300);function g(){p.currentPage===1?C():p.currentPage=1}const $=v();function K(s){$.value=s,C()}H([()=>p.currentPage,()=>p.pageSize,()=>U().marketData,()=>Ge().config,()=>U().buyStatus,()=>U().sellStatus],C,{immediate:!0}),H(()=>R(),()=>{C()},{deep:!0});const j=v(),V=v(!1);async function Q(s){j.value=q(s),V.value=!0}const k=v(!1),N=v();function Y(s){if(!R().activated){Me.confirm(n("是否确定开启自定义价格？"),n("需先开启自定义价格"),{confirmButtonText:n("确定"),cancelButtonText:n("取消"),closeOnClickModal:!0}).then(()=>{R().setActivated(!0)});return}N.value=q(s),k.value=!0}const{t:n}=de(),X=Re();function Z(s){var c;const o=((c=s==null?void 0:s.calculator)==null?void 0:c.enhanceLevel)??(s==null?void 0:s.enhanceLevel),f=Math.floor(Number(o));if(Number.isFinite(f)&&!(f<1||f>20))return f}function w(s){const o=s==null?void 0:s.hrid;if(!o)return;const f=Z(s);X.push({path:"/enhancer",query:{hrid:o,enhanceLevel:f!==void 0?String(f):void 0}})}function ee(s){var _;const o=s==null?void 0:s.hrid,f=((_=s==null?void 0:s.calculator)==null?void 0:_.enhanceLevel)??0,c=Oe(o,f).vol??-1;return c<0?"-":qe(c)}const le=Je("jungle-price-status");return(s,o)=>{const f=ze,c=Ee,_=Ie,B=Fe,ae=De,d=ve,z=be,I=Ce("Warning"),F=xe,M=ye,te=Se,ne=he,oe=fe,T=pe,se=me,ie=_e;return h(),y("div",Ye,[r("div",Xe,[a(Te),r("div",null,[a(Ae,{actions:["enhancing","cheesesmithing","crafting","tailoring"],equipments:["off_hand","hands","neck","earrings","ring","pouch"]})]),a(Ke,{onChange:l(le)},null,8,["onChange"]),r("div",null,i(l(n)("打野爽！")),1)]),a(se,{gutter:20,class:"row"},{default:t(()=>[a(T,{xs:24,sm:24,md:24,lg:24,xl:16},{default:t(()=>[a(oe,null,{header:t(()=>[a(ae,{class:"rank-card",ref_key:"ldSearchFormRef",ref:J,inline:!0,model:l(u)},{default:t(()=>[r("div",Ze,i(l(n)("利润排行")),1),a(c,{prop:"name",label:l(n)("物品")},{default:t(()=>[a(f,{style:{width:"100px"},modelValue:l(u).name,"onUpdate:modelValue":o[0]||(o[0]=e=>l(u).name=e),placeholder:l(n)("请输入"),clearable:"",onInput:g},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(c,{label:l(n)("目标等级从")},{default:t(()=>[a(_,{style:{width:"80px"},min:1,max:20,modelValue:l(u).minLevel,"onUpdate:modelValue":o[1]||(o[1]=e=>l(u).minLevel=e),placeholder:"1",clearable:"",onChange:g,"controls-position":"right"},null,8,["modelValue"]),m(" "+i(l(n)("到"))+"  ",1),a(_,{style:{width:"80px"},min:1,max:20,modelValue:l(u).maxLevel,"onUpdate:modelValue":o[2]||(o[2]=e=>l(u).maxLevel=e),placeholder:"20",clearable:"",onChange:g,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"]),a(c,{label:`${l(n)("售价")} ≥`},{default:t(()=>[a(_,{style:{width:"80px"},modelValue:l(u).minSellPrice,"onUpdate:modelValue":o[3]||(o[3]=e=>l(u).minSellPrice=e),placeholder:"0",clearable:"",onChange:g,controls:!1},null,8,["modelValue"]),o[11]||(o[11]=m(" M "))]),_:1},8,["label"]),a(c,{label:`${l(n)("物品等级")} ≥`},{default:t(()=>[a(_,{style:{width:"80px"},modelValue:l(u).minItemLevel,"onUpdate:modelValue":o[4]||(o[4]=e=>l(u).minItemLevel=e),placeholder:"0",clearable:"",onChange:g,controls:!1},null,8,["modelValue"])]),_:1},8,["label"]),a(c,{label:`${l(n)("物品等级")} ≤`},{default:t(()=>[a(_,{style:{width:"80px"},modelValue:l(u).maxItemLevel,"onUpdate:modelValue":o[5]||(o[5]=e=>l(u).maxItemLevel=e),placeholder:"",clearable:"",onChange:g,controls:!1},null,8,["modelValue"])]),_:1},8,["label"]),a(c,{label:`${l(n)("风险")} ≤`},{default:t(()=>[a(_,{style:{width:"80px"},modelValue:l(u).maxRisk,"onUpdate:modelValue":o[6]||(o[6]=e=>l(u).maxRisk=e),clearable:"",onChange:g,controls:!1},null,8,["modelValue"])]),_:1},8,["label"]),a(c,null,{default:t(()=>[a(B,{modelValue:l(u).bestManufacture,"onUpdate:modelValue":o[7]||(o[7]=e=>l(u).bestManufacture=e),onChange:g},{default:t(()=>[m(i(l(n)("最佳制作方案")),1)]),_:1},8,["modelValue"])]),_:1}),a(c,null,{default:t(()=>[a(B,{modelValue:l(u).banCharm,"onUpdate:modelValue":o[8]||(o[8]=e=>l(u).banCharm=e),onChange:g},{default:t(()=>[m(i(l(n)("排除护符")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),default:t(()=>[ge((h(),x(te,{data:l(D),onSortChange:K},{default:t(()=>[a(d,{width:"54"},{default:t(({row:e})=>[a(S,{hrid:e.hrid},null,8,["hrid"])]),_:1}),a(d,{prop:"result.name",label:l(n)("物品")},null,8,["label"]),a(d,{"min-width":"70"},{default:t(({row:e})=>[r("div",we,[e.calculatorList&&e.calculatorList[e.calculatorList.length-1].protectLevel<e.calculatorList[e.calculatorList.length-1].enhanceLevel?(h(),x(S,{key:0,hrid:e.calculatorList[e.calculatorList.length-1].protectionItem.hrid},null,8,["hrid"])):b("",!0),e.protectLevel<e.enhanceLevel?(h(),x(S,{key:1,hrid:e.protectionItem.hrid},null,8,["hrid"])):b("",!0),e.catalyst?(h(),x(S,{key:2,hrid:`/items/${e.catalyst}`},null,8,["hrid"])):b("",!0)]),e.calculatorList&&e.calculatorList[e.calculatorList.length-1].protectLevel<e.calculatorList[e.calculatorList.length-1].enhanceLevel?(h(),y("div",el,i(l(n)("从{0}保护",[e.calculatorList[e.calculatorList.length-1].protectLevel])),1)):b("",!0),e.protectLevel<e.enhanceLevel?(h(),y("div",ll,i(l(n)("从{0}保护",[e.protectLevel])),1)):b("",!0)]),_:1}),a(d,{prop:"project",label:l(n)("动作")},null,8,["label"]),a(d,{prop:"result.profitPH",label:l(n)("利润 / h"),align:"center","min-width":"120",sortable:"custom","sort-orders":["ascending",null]},{default:t(({row:e})=>[r("span",{class:P(e.hasManualPrice?"manual":"")},i(e.result.profitPHFormat)+"  ",3),a(z,{type:"primary",icon:l(Le),onClick:L=>Y(e)},{default:t(()=>[m(i(l(n)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),a(d,{label:l(n)("损耗 / h"),align:"center"},{default:t(({row:e})=>[m(i(e.result.cost4EnhancePHFormat),1)]),_:1},8,["label"]),a(d,{align:"center","min-width":"120"},{header:t(()=>[r("div",al,[r("div",null,i(l(n)("风险系数")),1),a(M,{placement:"top",effect:"light"},{content:t(()=>[m(i(l(n)("损耗 ÷ 利润")),1)]),default:t(()=>[a(F,null,{default:t(()=>[a(I)]),_:1})]),_:1})])]),default:t(({row:e})=>[r("span",{class:P({error:e.result.risk>7,success:e.result.risk<5})},i(e.result.profitPH>0?e.result.riskFormat:""),3)]),_:1}),a(d,{align:"center",label:l(n)("利润率")},{default:t(({row:e})=>[r("span",{class:P(e.hasManualPrice?"manual":"")},i(e.result.profitRateFormat)+"  ",3)]),_:1},8,["label"]),a(d,{align:"center","min-width":"120"},{header:t(()=>[r("div",tl,[r("div",null,i(l(n)("利润 / 次")),1),a(M,{placement:"top",effect:"light"},{content:t(()=>[m(i(l(n)("单次动作产生的利润。"))+" ",1),o[12]||(o[12]=r("br",null,null,-1)),m(" "+i(l(n)("#多步动作利润提示"))+" ",1),o[13]||(o[13]=r("br",null,null,-1)),m(" "+i(l(n)("#多步动作利润举例")),1)]),default:t(()=>[a(F,null,{default:t(()=>[a(I)]),_:1})]),_:1})])]),default:t(({row:e})=>[r("span",{class:P(e.hasManualPrice?"manual":"")},i(e.result.profitPPFormat)+"  ",3)]),_:1}),a(d,{label:l(n)("售价"),align:"center"},{default:t(({row:e})=>[r("span",null,i(He(e.calculator.productListWithPrice[0].price)),1)]),_:1},8,["label"]),a(d,{label:l(n)("成交量(1h)"),align:"center","min-width":"120"},{default:t(({row:e})=>[m(i(ee(e)),1)]),_:1},8,["label"]),a(d,{label:l(n)("到强化工具中查看"),align:"center","min-width":"140"},{default:t(({row:e})=>[a(z,{type:"primary",onClick:L=>w(e)},{default:t(()=>[m(i(l(n)("到强化工具中查看")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"]),a(d,{"min-width":"120",label:l(n)("经验 / h"),align:"center"},{default:t(({row:e})=>{var L;return[r("div",nl,[r("div",null,i(e.result.expPHFormat),1),((L=e.expList)==null?void 0:L.length)>1?(h(),x(M,{key:0,placement:"top",effect:"light"},{content:t(()=>[(h(!0),y(Ve,null,ke(e.expList,(A,re)=>(h(),y("div",{key:re,style:{display:"flex",gap:"10px"}},[r("div",null,i(l(n)(A.action)),1),r("div",null,i(A.expPHFormat),1)]))),128))]),default:t(()=>[a(F,null,{default:t(()=>[a(I)]),_:1})]),_:2},1024)):b("",!0)])]}),_:1},8,["label"]),a(d,{label:l(n)("详情"),align:"center"},{default:t(({row:e})=>[a(z,{type:"primary",icon:l(Pe),onClick:L=>Q(e)},{default:t(()=>[m(i(l(n)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[ie,l(E)]])]),footer:t(()=>[r("div",ol,[a(ne,{background:"",layout:l(p).layout,"page-sizes":l(p).pageSizes,total:l(p).total,"page-size":l(p).pageSize,"current-page":l(p).currentPage,onSizeChange:l(W),onCurrentChange:l(G)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),a(T,{xs:24,sm:24,md:24,lg:24,xl:8},{default:t(()=>[a(Be,{"memory-key":"jungle"})]),_:1})]),_:1}),a(je,{modelValue:l(V),"onUpdate:modelValue":o[9]||(o[9]=e=>O(V)?V.value=e:null),data:l(j)},null,8,["modelValue","data"]),a(Ne,{modelValue:l(k),"onUpdate:modelValue":o[10]||(o[10]=e=>O(k)?k.value=e:null),data:l(N)},null,8,["modelValue","data"])])}}}),vl=Qe(sl,[["__scopeId","data-v-8e70200d"]]);export{vl as default};
