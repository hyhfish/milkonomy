import{y as ue,k as de,r as v,aJ as pe,w as N,u as me,f as L,i as r,s as a,v as e,F as i,q as n,at as fe,a5 as W,av as _e,au as ge,aK as he,ao as ve,aL as be,p as $,ax as Ce,G as b,Y as q,az as xe,aM as Le,a0 as ye,V as Pe,n as De,D as Se,O as Ve,P as ke,aN as Ee,aw as we,aO as Ie,aP as ze,aD as Me,aT as Fe,aU as Te,ay as je,aR as J,aS as He,h as C}from"./vue-CMGQ9A1z.js";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang-BTWGwO90.js";import{h as Oe,b as Re,c as Ue,d as Ae,u as Be,a as Ge,A as Ne,_ as We,M as $e}from"./ManualPriceCard-tG8i4i1F.js";import{h as qe,M as Je,i as Y,G as Ke,A as Ye,a as Qe,e as S,f as w,u as Xe}from"./GameInfo-BGd6k-DU.js";import{w as I,l as Ze,x as z,v as M}from"./index-CYQyJvlF.js";import{u as ea}from"./usePriceStatus-Ci3Oq_UV.js";import{_ as aa}from"./PriceStatusSelect.vue_vue_type_script_setup_true_lang-D3vbAgf1.js";import{_ as ta}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./workflow-fnf6-20P.js";const{t:la}=Ze.global;async function na(p){let o=[];if(I().getInheritCache())o=I().getInheritCache();else{await new Promise(f=>setTimeout(f,300));const m=Date.now();try{o=o.concat(oa())}catch(f){console.error(f)}I().setInheritCache(o),ue.success(la("计算完成，耗时{0}秒",[(Date.now()-m)/1e3]))}return o=o.filter(m=>p.maxLevel?m.originLevel<=p.maxLevel:!0),o=o.filter(m=>p.minLevel?m.originLevel>=p.minLevel:!0),Oe(Re(Ue(o,p),p),p)}function oa(){const p=qe(),o=Object.values(p.itemDetailMap),m=[];return o.filter(f=>f.enhancementCosts).forEach(f=>{for(let g=1;g<=20;g++){const V=[[z("锻造"),"cheesesmithing"],[z("制造"),"crafting"],[z("裁缝"),"tailoring"]];for(const[c,x]of V){const h=new Je({hrid:f.hrid,project:c,action:x,originLevel:g}),_=h.actionItem;!(_!=null&&_.upgradeItemHrid)||_.upgradeItemHrid==="/items/philosophers_stone"||Y(_.upgradeItemHrid,g,"ask")!==-1&&Y(f.hrid,Math.floor(h.targetLevel),"bid")!==-1&&Ae(m,h)}}}),m}const ia={class:"app-container"},sa={class:"game-info"},ra={class:"title"},ca={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ua={key:0},da={key:1},pa={style:{display:"flex","justify-content":"center","align-items":"center",gap:"5px"}},ma={class:"pager-wrapper"},fa=de({__name:"index",setup(p){const{paginationData:o,handleCurrentChange:m,handleSizeChange:f}=Be({},"inherit-leaderboard-pagination"),g=v([]),V=v(null),c=Ge("inherit-leaderboard-search-data",{name:"",project:"",profitRate:"",maxLevel:20,minLevel:1,banEquipment:!1,bestManufacture:!1}),x=v(!1),h=pe(()=>{x.value=!0,na({currentPage:o.currentPage,size:o.pageSize,...c.value,sort:F.value}).then(u=>{o.total=u.total,g.value=u.list}).catch(u=>{console.error(u),g.value=[]}).finally(()=>{x.value=!1})},300);function _(){o.currentPage===1?h():o.currentPage=1}const F=v();function Q(u){F.value=u,h()}N([()=>o.currentPage,()=>o.pageSize,()=>M().marketData,()=>Xe().config,()=>M().buyStatus,()=>M().sellStatus],h,{immediate:!0}),N(()=>w(),()=>{h()},{deep:!0});const T=v(),y=v(!1);async function X(u){T.value=J(u),y.value=!0}const P=v(!1),j=v();function Z(u){if(!w().activated){He.confirm(l("是否确定开启自定义价格？"),l("需先开启自定义价格"),{confirmButtonText:l("确定"),cancelButtonText:l("取消"),closeOnClickModal:!0}).then(()=>{w().setActivated(!0)});return}j.value=J(u),P.value=!0}const{t:l}=me(),ee=ea("inherit-price-status");return(u,s)=>{const ae=Me,k=ze,E=Te,te=Fe,H=je,le=Ie,d=Ce,O=xe,R=De("Warning"),U=Pe,A=ye,ne=we,oe=he,ie=ge,B=_e,se=fe,re=be;return C(),L("div",ia,[r("div",sa,[a(Ke),r("div",null,[a(Ye,{actions:["cheesesmithing","crafting","tailoring"],equipments:["off_hand","hands","neck","earrings","ring","pouch"]})]),a(aa,{onChange:e(ee)},null,8,["onChange"]),r("div",null,i(e(l)("继承爽！")),1)]),a(se,{gutter:20,class:"row"},{default:n(()=>[a(B,{xs:24,sm:24,md:24,lg:24,xl:16},{default:n(()=>[a(ie,null,{header:n(()=>[a(le,{class:"rank-card",ref_key:"ldSearchFormRef",ref:V,inline:!0,model:e(c)},{default:n(()=>[r("div",ra,i(e(l)("利润排行")),1),a(k,{prop:"name",label:e(l)("目标")},{default:n(()=>[a(ae,{style:{width:"100px"},modelValue:e(c).name,"onUpdate:modelValue":s[0]||(s[0]=t=>e(c).name=t),placeholder:e(l)("请输入"),clearable:"",onInput:_},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(k,{prop:"phone",label:e(l)("动作")},{default:n(()=>[a(te,{modelValue:e(c).project,"onUpdate:modelValue":s[1]||(s[1]=t=>e(c).project=t),placeholder:e(l)("请选择"),style:{width:"100px"},clearable:"",onChange:_},{default:n(()=>[a(E,{label:e(l)("锻造"),value:e(l)("锻造")},null,8,["label","value"]),a(E,{label:e(l)("制造"),value:e(l)("制造")},null,8,["label","value"]),a(E,{label:e(l)("裁缝"),value:e(l)("裁缝")},null,8,["label","value"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(k,{label:e(l)("初始等级从")},{default:n(()=>[a(H,{style:{width:"80px"},min:1,max:20,modelValue:e(c).minLevel,"onUpdate:modelValue":s[2]||(s[2]=t=>e(c).minLevel=t),placeholder:"1",clearable:"",onChange:_,"controls-position":"right"},null,8,["modelValue"]),b(" "+i(e(l)("到"))+"  ",1),a(H,{style:{width:"80px"},min:1,max:20,modelValue:e(c).maxLevel,"onUpdate:modelValue":s[3]||(s[3]=t=>e(c).maxLevel=t),placeholder:"20",clearable:"",onChange:_,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:n(()=>[ve((C(),$(ne,{data:e(g),onSortChange:Q},{default:n(()=>[a(d,{width:"54"},{default:n(({row:t})=>[a(K,{hrid:t.actionItem.upgradeItemHrid},null,8,["hrid"])]),_:1}),a(d,{label:e(l)("来源"),"min-width":"120"},{default:n(({row:t})=>[b(i(e(l)(e(Qe)(t.actionItem.upgradeItemHrid).name))+"+"+i(t.originLevel),1)]),_:1},8,["label"]),a(d,{width:"54"},{default:n(({row:t})=>[a(K,{hrid:t.hrid},null,8,["hrid"])]),_:1}),a(d,{label:e(l)("目标"),"min-width":"120"},{default:n(({row:t})=>[b(i(t.result.name)+"+"+i(t.targetLevel),1)]),_:1},8,["label"]),a(d,{prop:"project",label:e(l)("动作")},null,8,["label"]),a(d,{prop:"result.profitPHFormat",label:e(l)("利润 / h"),align:"center","min-width":"120"},{default:n(({row:t})=>[r("span",{class:q(t.hasManualPrice?"manual":"")},i(t.result.profitPHFormat)+"  ",3),a(O,{type:"primary",icon:e(Le),onClick:D=>Z(t)},{default:n(()=>[b(i(e(l)("自定义")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"]),a(d,{align:"center","min-width":"120"},{header:n(()=>[r("div",ca,[r("div",null,i(e(l)("利润 / 次")),1),a(A,{placement:"top",effect:"light"},{content:n(()=>[b(i(e(l)("单次动作产生的利润。"))+" ",1),s[6]||(s[6]=r("br",null,null,-1)),b(" "+i(e(l)("#多步动作利润提示"))+" ",1),s[7]||(s[7]=r("br",null,null,-1)),b(" "+i(e(l)("#多步动作利润举例")),1)]),default:n(()=>[a(U,null,{default:n(()=>[a(R)]),_:1})]),_:1})])]),default:n(({row:t})=>[r("span",{class:q(t.hasManualPrice?"manual":"")},i(t.result.profitPPFormat)+"  ",3)]),_:1}),a(d,{label:e(l)("买价"),align:"center"},{default:n(({row:t})=>[r("span",null,i(S(t.ingredientListWithPrice[0].price)),1)]),_:1},8,["label"]),a(d,{label:e(l)("售价"),align:"center"},{default:n(({row:t})=>[t.targetLevel%1===0?(C(),L("span",ua,i(S(t.productListWithPrice[0].price)),1)):(C(),L("span",da,i(S(t.productListWithPrice[0].price))+" | "+i(S(t.productListWithPrice[1].price)),1))]),_:1},8,["label"]),a(d,{"min-width":"120",label:e(l)("经验 / h"),align:"center"},{default:n(({row:t})=>{var D;return[r("div",pa,[r("div",null,i(t.result.expPHFormat),1),((D=t.expList)==null?void 0:D.length)>1?(C(),$(A,{key:0,placement:"top",effect:"light"},{content:n(()=>[(C(!0),L(Ve,null,ke(t.expList,(G,ce)=>(C(),L("div",{key:ce,style:{display:"flex",gap:"10px"}},[r("div",null,i(e(l)(G.action)),1),r("div",null,i(G.expPHFormat),1)]))),128))]),default:n(()=>[a(U,null,{default:n(()=>[a(R)]),_:1})]),_:2},1024)):Se("",!0)])]}),_:1},8,["label"]),a(d,{label:e(l)("详情"),align:"center"},{default:n(({row:t})=>[a(O,{type:"primary",icon:e(Ee),onClick:D=>X(t)},{default:n(()=>[b(i(e(l)("查看")),1)]),_:2},1032,["icon","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[re,e(x)]])]),footer:n(()=>[r("div",ma,[a(oe,{background:"",layout:e(o).layout,"page-sizes":e(o).pageSizes,total:e(o).total,"page-size":e(o).pageSize,"current-page":e(o).currentPage,onSizeChange:e(f),onCurrentChange:e(m)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})]),_:1}),a(B,{xs:24,sm:24,md:24,lg:24,xl:8},{default:n(()=>[a($e,{"memory-key":"inherit"})]),_:1})]),_:1}),a(Ne,{modelValue:e(y),"onUpdate:modelValue":s[4]||(s[4]=t=>W(y)?y.value=t:null),data:e(T)},null,8,["modelValue","data"]),a(We,{modelValue:e(P),"onUpdate:modelValue":s[5]||(s[5]=t=>W(P)?P.value=t:null),data:e(j)},null,8,["modelValue","data"])])}}}),Pa=ta(fa,[["__scopeId","data-v-4de8f182"]]);export{Pa as default};
